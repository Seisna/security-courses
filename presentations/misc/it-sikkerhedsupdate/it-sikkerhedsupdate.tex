\documentclass[Screen16to9,17pt]{foils}
\usepackage{zencurity-slides}


% It-sikkerhedsupdate
% Få fremtidssikret it-sikkerhedsstrategien. Arrangement for medlemmer af Forsikringsforbundet og PROSA.

% Hvad skal en ansvarlig it-sikkerhedsstrategi være for 2019. Hvilke emner er de vigtigste, og hvad er truslerne, hvis man ikke straks kommer i gang med de 10 vigtigste punkter.

% Foredraget er en gennemgang af de 10 vigtigste områder og emner, som en organisation skal have styr på i 2019, med referencer til aktuelle sager som eksempel.

% Punkterne vil inkludere de sædvanlige, kedelige, men nødvendige; backup, CMDB, brugerstyring, logging m.fl. - men med forslag til praktiske værktøjer for at understøtte dem hurtigt.

\begin{document}
\selectlanguage{danish}
\mytitlepage{It-sikkerhedsupdate}{\the\year}


\vskip 1cm
\centerline{\footnotesize slides are available on Github}
\slide{Goal for today}

\hlkimage{5cm}{Shaking-hands_web.jpg}

What are the things on the table for a responsible it-security strategy. Which subjects are most important, and what are the threats, if you dont get started immediately with the top 10 priorities.


\begin{list2}
\item Plan:
\item Approx 4h, with breaks
\item Less presentation, more dialog
\item Inspiration for solving the tasks, prioritizing the tasks
\item I dont have tailer made solutions or easy answers for your organisation
\end{list2}

\slide{Every Year}

\hlkimage{4cm}{happy-new-year-roven-images-601197-unsplash.jpg}


\begin{list2}
\item Same problems last year? Same problems EVERY year
\item 2020 was a nightmare of break-ins and data leaks
\item Data leaks, GDPR, ransomware, ...
\end{list2}

\vskip 1cm
{\LARGE\bf Try not to panic, but there are lots of threats}

Are we loosing the battle?

\slide{Har du haft snakken med din CISO?}

%\hlkimage{}{}

\begin{quote}
{\bf IT-sikkerhed:}\\
Vi vil gerne bede om 10 millioner til IT-sikkerhed i budget næste år

{\bf CTO/CIO/CISO:}\\
Umuligt

{\bf IT-sikkerhed:}\\
OK, fair nok. Så skal vi bare bede om {\bf 100 millioner til Ransomware}, tak.

Husk også at uddanne CFO i bitcoin transaktioner.
\end{quote}

\begin{list2}
\item Er ovenstående urealistisk?
\end{list2}

\slide{Demant 2019}

%\hlkimage{}{}

\begin{quote}
- For året 2019 rapporterede vi et tab i omsætning på {\bf 575 millioner kroner}. Det i sig selv er alvorligt. Hvad angår vores opmærksomhed på it-sikkerhedsområdet, har it-hændelsen været med til at understrege nødvendigheden af, at tage dette felt seriøst. Angreb mod it-infrastruktur er uden tvivl en af de største trusler mod en virksomhed, og det kan gå galt, hvis man ikke er i stand til at lukke ned for skaden og bruge sin back-up.

...

- På det konkrete plan har vi fået et mantra der lyder {\bf ’Active Directory is king, and backup is Queen’}. Men mere overordnet har vi også lært at Focus skal helt op på øverste niveau i virksomheden, at man skal skaffe høj faglig indsigt i sikkerhed og trusler, og at det er et arbejde, der skal være under konstant observation og udvikling.

\end{quote}
Kilde: \link{https://dit.dk/Nyheder/2021/Demant}


\begin{list2}
\item Vi taler altså om tab i størrelsesorden tre-cifrede millionbeløb!
\end{list2}

\slide{Paranoia defined}

\hlkimage{10cm}{paranoia-definition.png}

Source: google paranoia definition

Use appropriate paranoia, and yes, hot pink red blinking is an appropriate threat level

\slide{Hackers don't give a shit}

\hlkrightpic{11cm}{-3cm}{kiwicon-2009-hackers-dont-give-shit.jpg}

Your system is only for testing, development, ...

Your network is a research network, under construction, \\
being phased out, ...

Try something new, go to your management

Bring all the exceptions, all of them, update the risk \\
analysis figures - if this happens it is about 1mill DKK

Ask for permission to go full monty on your security

{\bf Think like attackers - don't hold back}


\slide{Confidentiality Integrity Availability}

\hlkimage{8cm}{cia-triad-uk.pdf}

\begin{list1}
\item We want to protect something
\item Confidentiality - data kept secret
\item Integrity - no unauthorized changes to data
\item Availability - data and systems are available to authorized uses when they need them
\end{list1}

\slide{Security engineering as a job role}

\begin{alltt}\small
On any given day, you may be challenged to:
        Create new ways to solve existing production security issues
        Configure and install firewalls and intrusion detection systems
        Perform vulnerability testing, risk analyses and security assessments
        Develop automation scripts to handle and track incidents
        Investigate intrusion incidents, conduct forensic investigations and incident responses
        Collaborate with colleagues on authentication, authorization and encryption solutions
        Evaluate new technologies and processes that enhance security capabilities
        Test security solutions using industry standard analysis criteria
        Deliver technical reports and formal papers on test findings
        Respond to information security issues during each stage of a project’s lifecycle
        Supervise changes in software, hardware, facilities, telecommunications and user needs
        Define, implement and maintain corporate security policies
        Analyze and advise on new security technologies and program conformance
        Recommend modifications in legal, technical and regulatory areas that affect IT security
\end{alltt}

Source: \url{https://www.cyberdegrees.org/jobs/security-engineer/}\\
also
\url{https://en.wikipedia.org/wiki/Security_engineering}



\slide{Focus on the basics}

\begin{list2}
\item User management - including administrative users
\item Asset management
\item Laptop security
\item Penetration testing
\item Firewalls and segmentation
\item VPN everywhere
\item TLS and VPN settings, encryption
\item DNS and email security
\item Syslog and monitorering
\item Incident Response and response
\end{list2}

\vskip 5mm
\centerline{I hope you have a team, otherwise choose a few at a time}



\slide{Focus: User management}

\hlkimage{8cm}{humans2.png}

\begin{list2}
\item Relevant for alle organisationer
\item Er måden vi sikrer godkendte brugere kan udføre opgaver
\item Kodeord bruges til at forhindre uautoriseret adgang
\item Har I styr på brugerid?
\item Hvor er brugere oprettet?
\item Hvor hurtigt kan I fjerne "een bruger" eller "deaktivere en bruger" alle steder!
\item Er det et kludetæppe - ja, mange steder er det
\end{list2}


\slide{Local administrator?}

\hlkimage{10cm}{dragon-drawing-6.jpg}

\begin{list2}
\item Findes der systemer som er helt åbne, med lokal administrator
\item Er det stadig nødvendigt
\end{list2}


\slide{Centralized User management}

\begin{list1}
\item Active Directory, mange danske virksomheder bruger det
\item LDAP central brugerstyring
\item ... men brug det endnu mere
\begin{list2}
\item Konfigurer applikationer til central styring
\item Fjern applikationer som ikke tillader central styring
\item Overvågning på fejlslagne logins, og godkendte logins
\end{list2}
\item Generelt minimer brugere andre steder end i den centrale database
\end{list1}

\vskip 1cm
Hvad med ILO, DRAC, temperaturovervågning - en fælles password database, med begrænset adgang, måske?


\slide{Passwords vælges ikke tilfældigt}

\hlkimage{20cm}{50-most-used-passwords.png}

Source:
\link{https://wpengine.com/unmasked/}


\slide{Your data has already have been owned by criminals}

\hlkimage{13cm}{pwned.png}

\begin{list1}
\item Your data is already being sold, and resold on the Internet
\item Stop reusing passwords, use a password safe to generate and remember
\item Check you own email addresses on \link{https://haveibeenpwned.com/}
\end{list1}

\centerline{They have an API you can integrate to}


\slide{Brug mere sikre passwords}

\begin{quote}
Pwned Passwords overview\\
Pwned Passwords are more than half a billion passwords which have previously been exposed in data breaches. The service is detailed in the launch blog post then further expanded on with the release of version 2. The entire data set is both downloadable and searchable online via the Pwned Passwords page.
\end{quote}

\begin{list1}
\item I kan forhindre brugere i at vælge passwords der ALLEREDE er lækket
\item I kan bruge deres API eller download\\
{\footnotesize\link{https://www.troyhunt.com/introducing-306-million-freely-downloadable-pwned-passwords/}}
\end{list1}


\slide{Opbevaring af passwords}

\hlkimage{6cm}{password-window.png}

\begin{list2}
\item Use password managers! Available as cloud connected, local only, teams based
\item You will have to investigate which one to choose, but find one!
\end{list2}




\slide{Focus: Asset management}

\hlkimage{7cm}{old_book_lumen_design_st_01.png}

\begin{list2}
\item Specielt relevant for mellemstore til store organisationer
\item Hvilke assets har vi?
\item Hvordan sikrer vi at vi ikke mister værdierne
\end{list2}


\slide{What is asset management}

\begin{quote}
CIS Control 1:\\
Inventory and Control of Hardware Assets
Actively manage (inventory, track, and correct) all hardware devices on the network so that only
authorized devices are given access, and unauthorized and unmanaged devices are found and
prevented from gaining access.
\end{quote}
Source: \link{https://www.cisecurity.org/}

\begin{list2}
\item Hardware - både indkøbte, opkoblede, udlånte, stjålne ...
\item Software - licenser, indkøb, brug, opgraderingspriser
\item Virtuelle arkiver - eksempelvis forretningskritiske data
\item ...
\end{list2}


\slide{Hardware asset management}

\hlkimage{10cm}{racktables-shot-indexpage.png}

\begin{list2}
\item Der findes mange systermer
\item Det anbefales at bruge specialiserede systemer, a la RackTables:\\
Have a list of all devices you've got,
Have a list of all racks and enclosures,
Mount the devices into the racks,
Maintain physical ports of the devices and links between them
\end{list2}

\slide{Software asset management - virtuelle arkiver}

\hlkimage{9cm}{datalaek-2019.png}

\begin{list2}
\item Software - licenser, indkøb, brug, opgraderingspriser
\item Virtuelle maskiner - er en server et asset, eller er det data?
\item IP adresser
\item Data arkiver - GDPR
\end{list2}

\slide{IP Address Management IPAM }

\hlkimage{18cm}{nipap-search.png}
\begin{list2}
\item Anbefaler Nipap \link{http://spritelink.github.io/NIPAP/}
\end{list2}

\slide{Har du styr på afhængighederne}

.
\hlkrightpic{10cm}{-5cm}{kyler-trautner-693525-unsplash.jpg}

\begin{list2}
\item Skal det være helt flot så få også styr på dependencies
\item Er jeres produktion afhængig af andres moduler, biblioteker osv.
\item Tænk tilbage til Heartbleed, gik flere år før de sidste opdateringer kom
\item Container scannere, hvilke sårbarheder er der under jeres applikationer
\item Nyt ord supply-chain attacks: Solarwinds sagen
\end{list2}



\slide{Focus: Laptop sikkerhed}

\hlkimage{13cm}{kelly-sikkema-212376-unsplash.jpg}

\begin{list2}
\item Relevant for alle
\item Hvordan sikrer vi at vi ikke mister værdierne, hardware og data typisk
\end{list2}


\slide{Secure Laptops}

\hlkimage{10cm}{librem-15-v3-turns99.png}

\begin{list2}
\item Laptops (og mobile enheder)
\item Hvad kendetegner en laptop?
\item Hardware naturligvis, en Macbook koster officielt mere end en brugt mellemklassebil
\item - og husk brugen af laptops
\item Er laptops sikre, og hvad betyder det?
\end{list2}



\slide{Are your data secure - data at rest}

\hlkimage{15cm}{images/data-integrity-1.pdf}

\begin{list1}
\item Stolen laptop, tablet, phone - can anybody read your data?
\item Do you trust "remote wipe"
\item How do you in fact wipe data securely off devices, and SSDs?
\item Encrypt disk and storage devices before using them in the first place!
\end{list1}


\slide{Circumvent security - single user mode boot}
\begin{list1}
\item Unix systems often allows boot into singleuser mode\\
press command-s when booting Mac OS X
\item Laptops can often be booted using PXE network or CD boot
\item Mac computers can become a Firewire disk\\
hold t when booting - firewire target mode
\item Unrestricted access to un-encrypted data
\item Moving hard drive to another computer is also easy
\end{list1}
\pause
\centerline{Physical access is often - {\bf game over}}


\slide{Encrypting hard disk}

\hlkimage{12cm}{images/apple-filevault.png}

\begin{list1}
\item Becoming available in the most popular client operating systems
\begin{list2}
\item Microsoft Windows Bitlocker
\item Apple Mac OS X - FileVault
\item FreeBSD GEOM og GBDE - encryption framework
\item Linux LUKS distributions like Ubuntu ask to encrypt home dir during installation
\item Some vendors have BIOS passwords, or disk passwords
\end{list2}
\end{list1}


\slide{Attacks on disk encryption}

\begin{list1}
\item Firewire, DMA \& Windows, Winlockpwn via FireWire\\
Hit by a Bus: Physical Access Attacks with Firewire Ruxcon 2006
\vskip 5mm
\item Removing memory from live system - data is not immediately lost, and can be read under some circumstances\\
Lest We Remember: Cold Boot Attacks on Encryption Keys\\
\link{http://citp.princeton.edu/memory/}
\item This is very CSI or Hollywoord like - but a real threat
\item VileFault decrypts encrypted Mac OS X disk image files\\ \link{https://code.google.com/p/vilefault/}

\item  FileVault Drive Encryption (FVDE) (or FileVault2) encrypted volumes\\
\link{https://code.google.com/p/libfvde/}
\end{list1}

\centerline{So perhaps use both hard drive encryption AND turn off computer after use?}

\slide{... and deleting data}

\hlkimage{8cm}{dban-screenshot.png}

\begin{list1}
\item Getting rid of data from old devices is a pain
\item Some tools will not overwrite data, leaving it vulnerable to recovery
\item Even secure erase programs might not work on SSD - due to reallocation of blocks
\item I have used Darik's Boot and Nuke ("DBAN") \link{http://www.dban.org/}
\end{list1}


\slide{2018 attack}

\hlkimage{12cm}{ssd-attack-2018.png}
\emph{self-encrypting deception: weakness in the encryption of solid state drives (SSDs)}\\
\link{https://www.ru.nl/publish/pages/909282/draft-paper.pdf}





\slide{Recommendations - Comply Everywhere, Act Anywhere}

\hlkrightpic{5cm}{-1cm}{003scawebgoshindomanicon.png}
{~}
\begin{list1}
\item {\bf Laptop storage must be encrypted}
\item Firewall must be enabled
\item Next suggestion:
\begin{list2}
\item Try sniffing data from a laptop, setup Access Point/Monitor port
\item Portscan your laptop networks - use Nmap
\item Write an email to everyone in your organisation:\\
"Hi All, we need to identify laptops without full disk encryption \\
- come see us, we have christmas cookies left, Best regards IT"
\end{list2}
\end{list1}


\slide{Focus: Penetration testing}

\hlkimage{19cm}{burp-default-proxy-intercept.png}

\begin{list2}
\item Relevant hvis du driver et netværk, specielt hvis det er forbundet til internet eller stort
\item Du bliver hele tiden testet - internet-tinnitus
\item Penetration testing
\item Kontrol af sikkerheden med aktive værktøjer
\item Brug Nmap pakken til at checke åbne porte
\item Køb Burp Suite hvis du har et web site du tjener penge på
\end{list2}


\slide{Start Attacking from the Inside}

\hlkimage{6cm}{erik-odiin-568459-unsplash.jpg}


\begin{list2}
\item Now imagine you were in control of a company laptop
\item Do you have a large internal world wide network?\\
Having a large open network may cost you {\bf 1.9 billion DKK - ref Maersk case}
\item Try scanning everything, start in a small corner, expand
\item Scan all you danish segments, one by one, then the nordic, then the world
\item Yes, things may break - FINE, BREAKING is GOOD
\end{list2}

\centerline{\bf Better to break while we are ready to un-break}

\slide{How to break stuff}

Think like an attacker, and begin at the bottom.

I sit here, but where am I connected:
\begin{alltt}\footnotesize
reading from file cisco-lldp-1.cap, link-type EN10MB (Ethernet)
16:39:43.468745 LLDP, length 328
        Chassis ID TLV (1), length 7
          Subtype MAC address (4): 70:ff:1a:01:03:02 (oui Unknown)
        Port ID TLV (2), length 8
          Subtype Local (7): Eth1/47
        Port Description TLV (4), length 12: Ethernet1/47
        System Description TLV (6), length 158
          Cisco Nexus Operating System (NX-OS) Software 14.0(2c) TAC support: http://www.cisco.com/tac Copyright (c) 2002-2020, Cisco Systems, Inc. All rights reserved.
\end{alltt}

\vskip 5mm
\centerline{I love LLDP, but it does reveal software version, so be careful}
Check \emph{Security Assessment of Cisco ACI} -- 6 CVEs in one product, from a few weeks of testing\\
\link{https://www.ernw.de/en/whitepapers/issue-68.html}

\slide{Hackertools are for everyone!}

\hlkrightpic{10cm}{0cm}{kali-linux.png}
Hackers work all the time to break stuff

Blue teams can use hackertools, and become more effecient:
\begin{list2}
\item Nmap, Nping \link{http://nmap.org}
\item Wireshark - \link{http://www.wireshark.org/}
\item Aircrack-ng \link{http://www.aircrack-ng.org/}
\item Metasploit Framework \link{http://www.metasploit.com/}
\item Burpsuite \link{http://portswigger.net/burp/}
\item Kali Linux \link{http://www.kali.org}
\end{list2}

\vskip 5mm
\centerline{Most popular hacker tools \link{https://tools.kali.org/} and \link{http://sectools.org/}}


\slide{Aktiv testing What happens now?}

\begin{list1}
\item Think like a hacker
\item Recon phase -- gather information reconnaissance
\begin{list2}
\item Traceroute, Whois, DNS lookups
\item Ping sweep, port scan
\item OS detection -- TCP/IP and banner grabbing
\item Service scan -- rpcinfo, netbios, ...
\item telnet/netcat interact with services
\end{list2}
\end{list1}

\slide{Kali Linux the pentest toolbox}

\hlkimage{14cm}{kali-linux.png}

\begin{list1}
\item  Kali \link{http://www.kali.org/}
\item 100.000s of videos on youtube alone, searching for kali and \$TOOL
\item Also versions for Raspberry Pi, mobile and other small computers
\end{list1}



\slide{Nmap the world}

\hlkimage{19cm}{trinity-nmapscreen-hd-cropscale-418x250.jpg}


\slide{Really do Nmap your world}

\hlkrightpic{10cm}{0cm}{nmap-zenmap.png}
{~}

\begin{list2}
\item Nmap is a port scanner, but does more
\item Finding your own infrastructure available from the guest network?
\item See your printers having all the protocols enabled AND a wireless?
\item Includes scripting, and a lot of useful scripts by default
\item Often when a new vuln is published, there will be a test script for Nmap
\end{list2}
\slide{Hackerlab setup}

\hlkimage{11cm}{hacklab-1.png}

\begin{list2}
\item Create hacker labs, encourage hacker labs!
\item Software Host OS: Windows, Mac, Linux
\item Virtualisation software: VMware, Virtual box, HyperV pick your poison
\item Hackersoftware: Kali Virtual Machine \link{https://www.kali.org/}
\end{list2}

\slide{Hacking is not magic}

\hlkimage{11cm}{ninjas.png}

\begin{list2}
\item Hacking only requires some ninja training
\item We have been doing this since 1995 when SATAN was released
\item Listen, Plan, Act, Do hacking
\end{list2}

\slide{Book: Linux Basics for Hackers (LBfH)}

\hlkrightpic{4cm}{0cm}{LinuxBasicsforHackers_cover-front.png}
\link{https://nostarch.com/linuxbasicsforhackers}

\emph{Linux Basics for Hackers
Getting Started with Networking, Scripting, \\
and Security in Kali} by OccupyTheWeb December 2018, 248 pp.
ISBN-13: 9781593278557\\



Note: this book is about using Unix (Linux) but teaches this using Kali Linux

Running hacker tools comes after you can make directories and find your way around it


\slide{Book: Kali Linux Revealed (KLR)}

\hlkimage{6cm}{kali-linux-revealed.jpg}

\emph{Kali Linux Revealed  Mastering the Penetration Testing Distribution}

\link{https://www.kali.org/download-kali-linux-revealed-book/}\\
explains how to install Kali Linux

\slide{Focus: Firewalls og segmentering}

\hlkimage{10cm}{virksomhedens-netvaerk.pdf}

\begin{list2}
\item Hvis du har et netværk, så bør du have en firewall
\item En firewall tillader autoriseret trafik og blokerer resten
\item Hvornår har du sidst set din løsning efter?
\item Hvor lang tid tager det at se en 5.000 linier Cisco ASA config igennem?
\end{list2}

\slide{Imagine Attacks from the Inside}

\hlkimage{6cm}{erik-odiin-568459-unsplash.jpg}

\begin{list2}
\item Now imagine you were in control of a company laptop
\item Do you have a large internal world wide network?\\
NotPetya cost Maersk about 1.9 billion DKK
%\item Try scanning everything, start in a small corner, expand
%\item Scan all you danish segments, one by one, then the nordic, then the world
%\item Yes, things may break - FINE, BREAKING is GOOD

\item entry thought to be via software update of M.E.Doc [uk] an Ukrainian tax preparation program
\item Attackers are very creative and have a large attack surface to most companies
\end{list2}

\slide{Big firewalls}

\hlkimage{15cm}{network-layers-1.png}

\centerline{Big firewalls are not a single device}



\slide{IEEE 802.1q VLANs}

\hlkimage{16cm}{vlan-8021q.pdf}

\begin{list1}
\item Med 802.1q tillades VLAN tagging på Ethernet niveau
\item Data skal omkring en firewall eller en router for at krydse fra VLAN1 til VLAN2
\item VLAN trunking giver mulighed for at dele VLANs ud på flere switches
\end{list1}


\slide{Netværk generelt}

\hlkimage{10cm}{images/librenms-switches.png}

\begin{list2}
\item Måske også på tide lige at se om der er opdateringer til switche
\item Jeg anbefaler LibreNMS \link{https://www.librenms.org/}
\end{list2}


\slide{Focus: VPN alle steder}

\hlkimage{12cm}{ks-kyung-784757-unsplash.jpg}

\begin{list2}
\item VPN er relevant for alle der har data af værdi
\item Sikrer data der flyttes
\item Virtual Private Network dækker over klienter der kobler op, og site-2-site
\end{list2}

\slide{Your Privacy }

\hlkimage{15cm}{images/internet-browsing.pdf}


\begin{list2}
\item Your data travels far
\item Often crossing borders, virtually and literally
\end{list2}

\vskip 5mm
\centerline{\bf\Large Maybe use VPN more - or always!}





\slide{Focus 2020: SSL og TLS}

\hlkimage{7cm}{crypto-class.png}

\begin{list1}
\item Oprindeligt Secure Sockets Layer (SSL) udviklet af Netscape Communications Inc.
\item Adopteret af IETF og kaldes Transport Layer Security (TLS)
\item RFC-3207 SMTP STARTTLS
\item \emph{A Graduate Course in
Applied Cryptography}, Dan Boneh   and   Victor Shoup
\\ \link{https://toc.cryptobook.us/}
\item \emph{Serious Cryptography: a practical introduction to modern cryptography}, Jean-Philippe
Aumasson. 1st ed. (2017). No Starch Press. ISBN: 9781593278267.
\end{list1}

\slide{TLS og VPN indstillinger}

\begin{alltt}\footnotesize
  # Input from https://github.com/tykling/ansible-roles/blob/master/nginx_server/templates/tls.conf.j2#L6
  ssl_protocols                   TLSv1.2 TLSv1.3;
  ssl_ciphers                     ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA;
  ssl_prefer_server_ciphers       on;
  ssl_session_cache               shared:SSL:10m;     ssl_session_tickets       off;   ssl_session_timeout    4h;
  ssl_stapling                    on;                 ssl_stapling_verify       on;
  resolver                        105.238.53.1;
  ssl_ecdh_curve secp384r1;                           ssl_dhparam /etc/nginx/dh4096.pem;
  add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
  add_header Referrer-Policy "no-referrer";  add_header X-Content-Type-Options "nosniff";
  add_header X-Frame-Options "DENY";  add_header X-XSS-Protection "1; mode=block";
  add_header Content-Security-Policy "default-src 'self'; script-src 'self; img-src 'self'; object-src 'none'; font-src 'self'; frame-ancestors 'none' https:";
\end{alltt}

\begin{list2}
\item De fleste har https nu, men er det konfigureret optimalt
\item Anbefaler at alle indstillingerne gennemgås regelmæssigt!
\item Lav et dokument med de indstillinger I bruger i jeres organisation
\end{list2}



\slide{Nmap efter SSL og TLS}

\hlkimage{7cm}{nmap-sslv2.png}

\begin{list1}
\item Nu vi har lært Kali og Nmap at kende
\begin{list2}
\item Find nemt alle ssl version 2 og 3\\
\verb+nmap --script ssl-enum-ciphers+
\item Brug ssllabs https://www.ssllabs.com/
\end{list2}
\end{list1}


\slide{sslscan}

\begin{alltt}\small
root@kali:~# sslscan --ssl2 web.kramse.dk
Version: 1.10.5-static
OpenSSL 1.0.2e-dev xx XXX xxxx

Testing SSL server web.kramse.dk on port 443
...
  SSL Certificate:
Signature Algorithm: sha256WithRSAEncryption
RSA Key Strength:    2048

Subject:  *.kramse.dk
Altnames: DNS:*.kramse.dk, DNS:kramse.dk
Issuer:   AlphaSSL CA - SHA256 - G2
\end{alltt}

Source:
Originally sslscan from http://www.titania.co.uk
 but use the version on Kali

SSLscan can check your own sites, while Qualys SSLLabs only can test from hostname

\slide{TLS Best Current Practice guidelines}

%\hlkimage{}{}

\begin{quote}
Current recommendations are to phase out Transport Layer Security (TLS) version 1.0 and TLS version 1.1, and all
  previous versions of Secure Sockets Layer (SSL). DHE is Diffie-Hellman key exchange and should be
  updated to always use more than 1024 bit for example 2048 or 4096 bits.

\end{quote}

\begin{list2}
  \item Best current practice can be found in documents like:\\
{\footnotesize
\link{https://english.ncsc.nl/binaries/ncsc-en/documents/publications/2021/january/19/it-security-guidelines-for-transport-layer-security-2.1/IT+Security+Guidelines+for+Transport+Layer+Security+v2.1.pdf}}

\end{list2}


\slide{VPN indstillinger}

\hlkimage{9cm}{crypto-rot13.pdf}

\begin{list1}
\item PPTP og 3DES, fjern, kill on sight
\item Check hvert år:
\begin{list2}
\item Certifikater/nøgler - ligesom TLS lange og rulles indimellem
\item Algoritmer DES/3DES bye bye, husk både encryption og auth algoritmer
\item DH-Group - +15 tak
\item Check både client VPN og site-2-site
\end{list2}
\end{list1}

\slide{Anbefalinger til VPN}

\begin{quote}
  Use the following guidelines when configuring Internet Key Exchange (IKE) in VPN technologies:\\
* Avoid IKE Groups 1, 2, and 5.\\
* Use IKE Group 15 or 16 and employ 3072-bit and 4096-bit DH, respectively.\\
* When possible, use IKE Group 19 or 20. They are the 256-bit and \\
384-bit ECDH groups, respectively.\\
* Use AES for encryption.
\end{quote}
Paper:\\
{\small \link{https://www.cisco.com/c/en/us/about/security-center/next-generation-cryptography.html}}

\begin{list2}
\item Certifikater/nøgler - ligesom TLS lange og rulles indimellem
\item Algoritmer DES/3DES bye bye, husk både encryption og auth algoritmer
\item DH-Group - +15 tak
\item Check både client VPN og site-2-site
\end{list2}

\slide{Focus: DNS og email}

\hlkimage{4cm}{brian-patrick-tagalog-680954-unsplash.jpg}

\begin{list2}
\item Vi er afhængige af email, modtagelse og afsendelse
\item Når vi modtager skal det helst gå hurtigt
\item Når vi sender skal vi ikke ende i spam mappen
\item Phishing, hvem kan sende \emph{fra vores domæne}
\end{list2}


\slide{Various key attack types, clients and employees}

\begin{list2}
\item Phishing - sending fake emails, to collect credentials
\item Spear phishing - targetted attacks
\item Person in the middle - sniffing and changing data in transit
\item Drive-by attacks - web pages infected with malware, often ad servers
\item Malware transferred via USB or email
\item Credential Stuffing, Password related, like re-use of password, see slide about being pwned
\end{list2}

\vskip 1cm
\centerline{\Large\bf If we all wait a bit, and not click links immediately}

\vskip 1cm
Hackers try to create "urgency", click this or loose money

\slide{DNS er mere end navneopslag}

\begin{list1}
  \item består af resource records med en type:
    \begin{list2}
\item adresser A-records
\item IPv6 adresser AAAA-records
\item autoritative navneservere NS-records
\item post, mail-exchanger MX-records
\item flere andre: md ,  mf ,  cname ,  soa ,
                  mb , mg ,  mr ,  null ,  wks ,  ptr ,
                  hinfo ,  minfo ,  mx ....
\end{list2}
\end{list1}
\begin{alltt}
        IN      MX      10      mail.zencurity.dk.
        IN      MX      20      mail2.zencurity.dk.
\end{alltt}

\slide{SMTP Simple Mail Transfer Protocol}

\begin{alltt}\tiny
hlk@bigfoot:hlk$ telnet mail.kramse.dk 25
Connected to sunny.
220 sunny.kramse.dk ESMTP Postfix
HELO bigfoot
250 sunny.kramse.dk
MAIL FROM: Henrik
250 Ok
RCPT TO: hlk@kramse.dk
250 Ok
DATA
354 End data with <CR><LF>.<CR><LF>
hejsa
.
250 Ok: queued as 749193BD2
QUIT
221 Bye
\end{alltt}

\begin{list2}
\item RFC-821 SMTP Simple Mail Transfer Protocol fra 1982
\item \link{http://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol}
\end{list2}

\slide{DNS attacks, Your registrar}

\hlkimage{10cm}{krebs-lenovo-google-dns-hack.png}
\begin{list1}
%\item DNS is the Domain Name System, \link{https://en.wikipedia.org/wiki/Dns}
\item DNS insecurity has huge impact on your security!
\item Most are denial of service, by may create Mitm or confidentiality concerns
\item Select DNS providers with care
\end{list1}


Sources:\\
{\tiny
\link{https://krebsonsecurity.com/2015/02/webnic-registrar-blamed-for-hijack-of-lenovo-google-domains/}\\
\link{http://www.version2.dk/artikel/google-og-lenovo-defaced-som-foelge-af-overset-sikkerhedsproblemstilling-91295}}


\slide{DNSSEC get started now}

\hlkimage{12cm}{cz-nic-dnssec-tlsa-validator.png}

\begin{quote}
"TLSA records store hashes of remote server TLS/SSL certificates. The authenticity of a TLS/SSL certificate for a domain name is verified by DANE protocol (RFC 6698). DNSSEC and TLSA validation results are displayer by using several icons."
\end{quote}


\slide{DNSSEC and DANE}

\begin{quote}
"Objective:

Specify mechanisms and techniques that allow Internet applications to
establish cryptographically secured communications by using information
distributed through DNSSEC for discovering and authenticating public
keys which are associated with a service located at a domain name."
\end{quote}

\begin{list1}
\item DNS-based Authentication of Named Entities (dane)
\end{list1}

\slide{Email security - Goals}

\begin{list2}
\item SPF Sender Policy Framework\\ {\footnotesize\link{https://en.wikipedia.org/wiki/Sender_Policy_Framework}}
\item DKIM DomainKeys Identified Mail\\
{\footnotesize\link{https://en.wikipedia.org/wiki/DomainKeys_Identified_Mail}}
\item DMARC Domain-based Message Authentication, Reporting and Conformance\\
{\footnotesize\link{https://en.wikipedia.org/wiki/DMARC}}
\item DANE DNS-based Authentication of Named Entities\\ {\footnotesize\link{https://en.wikipedia.org/wiki/DNS-based_Authentication_of_Named_Entities}}
\item Brug allesammen, check efter ændringer!
\end{list2}

\centerline{Jeg er glad for at teste med \link{https://dmarcian.com/}}

\slide{Focus: Syslog og monitorering}

\hlkimage{7cm}{lup.png}

\begin{list2}
\item Vi har allesammen security incidents
\item Vi skal kunne efterforske, derfor er et niveau af syslog vigtigt
\item Også i dagligdagen til at sikre at systemerne kører optimalt
\end{list2}


\slide{Network Security Through Data Analysis}

\hlkimage{6cm}{network-security-through-data-analysis.png}

\begin{list2}
\item Low page count, but high value! Recommended.
\item \emph{Network Security through Data Analysis}, 2nd edition
By Michael S Collins Publisher: O'Reilly Media
06-10-2017, 428 Pages
\end{list2}


\slide{Graphs and Dashboards!}

\hlkimage{14cm}{Logstash1.png}

\begin{list2}
\item Screenshot from Peter Manev, OISF
\item Shown are Suricata IDS alerts processed by Logstash and Kibana
\end{list2}


\slide{Network tools - examples}

\hlkimage{12cm}{kibana-solido.png}

\begin{list2}
\item Net: Zeek \link{http://www.zeek.org} Suricata \link{http://suricata-ids.org}
\item DNS: DSC and PacketQ \link{https://github.com/dotse/packetq/wiki}
\item Syslog: Elasticsearch, Logstash, and Kibana, called ELK stack or Elastic stack
\end{list2}

\slide{Indicators of Compromise and Signatures}

\begin{quote}
An IOC is any piece of information that can be used to objectively describe a
network intrusion, expressed in a platform-independent manner. This could include a simple indicator such as the IP address of a command and control (C2) server or a complex set of behaviors that indicate that a mail server is being used as a malicious SMTP relay.

When an IOC is taken and used in a platform-specific language or format, such as a Snort Rule or a Bro-formatted file, it becomes part of a signature. A signature can contain one or more IOCs.
\end{quote}

Source: Applied Network Security Monitoring Collection, Detection, and Analysis, 2014 Chris Sanders


\slide{Storing query logs, old school or needed?}

\hlkimage{6cm}{bro-sample-ssl-scripts.png}

\begin{list2}
\item DNS query logs, keep it for at least a week?\\
- with DSC and PacketQ \link{https://github.com/DNS-OARC/PacketQ}
\item SSL/TLS log with Bro/Suricata\\
{\footnotesize\link{https://www.zeek.org/sphinx-git/script-reference/scripts.html}}
\item Log with Elasticsearch?\\
{\footnotesize\link{https://www.elastic.co/guide/en/elasticsearch/guide/current/index.html}}
%\item Even netflow session logging, full 1:1 - NFSen, Suricata Flow mode?
%\item Moloch \link{https://github.com/aol/moloch}
\end{list2}

\centerline{Uetisk? eller smart hvis man vil spore hvor malware kom ind}

\slide{Network visibility: Netflow with NFSen}

\hlkimage{15cm}{nfsen-udp-flood.png}

\centerline{An extra 100k packets per second from this netflow source (source is a router)}

Also look into Elastiflow! \link{https://github.com/robcowart/elastiflow}

\slide{How to get started}

\begin{list1}
\item How to get started searching for security events?
\item Collect basic data from your devices and networks
\begin{list2}
\item Netflow data from routers
\item Session data from firewalls
\item Logging from applications: email, web, proxy systems
\end{list2}
\item {\bf Centralize!}
\item Process data
\begin{list2}
\item Top 10: interesting due to high frequency, occurs often, brute-force attacks
\item {\it ignore}
\item Bottom 10: least-frequent messages are interesting
\end{list2}
\end{list1}

\slide{Case: Maltrail}

\hlkimage{15cm}{maltrail.png}

\link{https://github.com/stamparm/maltrail}




\slide{Next steps for monitoring}

In our network we are always improving things:
\begin{list1}
\item Suricata IDS \link{http://www.openinfosecfoundation.org/}
\item More graphs, with {\bf automatic identification} of IPs under attack
\item Identification of {\bf short sessions without data} - spoofed addresses
\item Alerting from {\bf existing} devices
\item Dashboards with key measurements
\end{list1}

\vskip 2cm
\centerline{\bf\Large Conclusion: Combine tools!}


\slide{Logstash pipeline }

\begin{verbatim}
input { stdin { } }
output {
  elasticsearch { host => localhost }
  stdout { codec => rubydebug }
}
\end{verbatim}

\begin{list2}
\item Logstash receives via {\bf input}
\item Processes with {\bf filters} - grok
\item Forward events with {\bf output}
\item Today many tools can produce JSON with fields already
\item Elastic also have defined: Elastic Common Schema (ECS)\\
\link{https://www.elastic.co/guide/en/ecs/current/index.html}
\end{list2}

%Source:
%Config snippet from recommended link\\
%{\small\link{http://logstash.net/docs/1.4.1/tutorials/getting-started-with-logstash}}

\slide{Logstash as SNMPtrap and syslog server}

{\footnotesize
\begin{verbatim}
input {
  snmptrap {
    host => "0.0.0.0"
    type => "snmptrap"
    port => 1062
    community => "xxxxx"
  }
  tcp {
    port => 5000
    type => syslog
  }
  udp {
    port => 5000
    type => syslog
  }
}
\end{verbatim}
}

\begin{list2}
\item We run logstash on port 5000 - but use IPtables port forwarding
\end{list2}

Maybe you have a device sending SNMP traps right now ...


\slide{Reklame: KEA Kompetence SIEM og log-analyse  (5 ECTS)}

Primary literature:
\begin{list2}
\item Data-Driven Security: Analysis, Visualization and Dashboards Jay Jacobs, Bob Rudis ISBN: 978-1-118-79372-5 February 2014 https://datadrivensecurity.info/
\item Crafting the InfoSec Playbook: Security Monitoring and Incident Response Master Plan by Jeff Bollinger, Brandon Enright, and Matthew Valites
\item Intelligence-Driven Incident Response ISBN: 9781491934944 Scott Roberts
\item Security Operations Center Building, Operating, and Maintaining your SOC ISBN: 9780134052014 Joseph Muniz
\end{list2}

{\footnotesize
Materiale er på min github @kramse

Lektionsplan:\\
\link{https://zencurity.gitbook.io/kea-it-sikkerhed/siem-and-log-analysis/lektionsplan}}



\slide{Focus: Incident Response og reaktion}

\hlkimage{10cm}{margarida-csilva-121801-unsplash.jpg}

\begin{list2}
\item Fortsat fra logningen ... hvad så nu!
\item Hvis du har en sikkerhedshændelse skal den håndteres
\item jo hurtigere og mere effektivt det håndteres jo bedre
\end{list2}

Lifeguard training photo by Margarida CSilva on Unsplash

\slide{Overlapping Security Incidents}

\hlkrightpic{12cm}{1cm}{datalaek-2019.png}

New data breaches nearly every week, these from danish news site \link{version2.dk}

Problem, we need to receive data from others

Data from others may contain malware

Have a job posting, yes\\
- then HR will be expecting CVs sent as .doc files

\slide{}

or the other way

{\Large\bf Attackers used a LinkedIn job ad\\
and Skype call to breach bank’s defences}
\hlkimage{12cm}{redbanc-skype-malware.png}

{\footnotesize
\link{https://nakedsecurity.sophos.com/2019/01/21/attackers-used-a-linkedin-job-ad-and-skype-call-to-breach-banks-defences/}}

\slide{Øv krisesituationer}

\hlkimage{12cm}{sheldon-nunes-1226991-unsplash.jpg}
\begin{list2}
\item Lav rollespil
\item Lav tabletop exercises
\end{list2}

\slide{Spørgsmål og mere debat}

\hlkimage{7cm}{idog.jpg}

\begin{center}
\hlkbig

\myname

\end{center}




\end{document}
