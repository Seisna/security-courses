\documentclass[Screen16to9,17pt]{foils}
\usepackage{zencurity-slides}


% It-sikkerhedsupdate 2019
% Få fremtidssikret it-sikkerhedsstrategien. Arrangement for medlemmer af Forsikringsforbundet og PROSA.

% Hvad skal en ansvarlig it-sikkerhedsstrategi være for 2019. Hvilke emner er de vigtigste, og hvad er truslerne, hvis man ikke straks kommer i gang med de 10 vigtigste punkter.

% Foredraget er en gennemgang af de 10 vigtigste områder og emner, som en organisation skal have styr på i 2019, med referencer til aktuelle sager som eksempel.

% Punkterne vil inkludere de sædvanlige, kedelige, men nødvendige; backup, CMDB, brugerstyring, logging m.fl. - men med forslag til praktiske værktøjer for at understøtte dem hurtigt.

\begin{document}
\selectlanguage{danish}
\mytitlepage{It-sikkerhedsupdate}{2019}


\vskip 1cm
\centerline{\footnotesize slides are available on Github}
\slide{Goal for today}

\hlkimage{5cm}{Shaking-hands_web.jpg}

What are the things on the table for a responsible it-security strategy for 2019. Which subjects are most important, and what are the threats, if you dont get started immediately with the top 10 priorities.


\begin{list2}
\item Plan:
\item Approx 4h, with breaks
\item Less presentation, more dialog
\item Inspiration for solving the tasks, prioritizing the tasks
\item I dont have tailer made solutions or easy answers for your organisation
\end{list2}

\slide{Happy New Year}

\hlkrightpic{10cm}{0cm}{happy-new-year-roven-images-601197-unsplash.jpg}
{~}

\begin{list2}
\item Same problems
\item Repeat last year?
\item ... or try something new!
\item 2020 was a nightmare of break-ins and data leaks
\item GDPR is here and the snow ball is rolling
\end{list2}

\vskip 1cm
{\LARGE\bf Try not to panic, but there are lots of threats}


\slide{Paranoia defined}

\hlkimage{12cm}{paranoia-definition.png}

Source: google paranoia definition


\slide{Hackers don't give a shit}

\hlkrightpic{11cm}{-3cm}{kiwicon-2009-hackers-dont-give-shit.jpg}

Your system is only for testing, development, ...

Your network is a research network, under construction, \\
being phased out, ...

Try something new, go to your management

Bring all the exceptions, all of them, update the risk \\
analysis figures - if this happens it is about 1mill DKK

Ask for permission to go full monty on your security

{\bf Think like attackers - don't hold back}


\slide{Confidentiality Integrity Availability}

\hlkimage{8cm}{cia-triad-uk.pdf}

\begin{list1}
\item We want to protect something
\item Confidentiality - data holdes hemmelige
\item Integrity - data ændres ikke uautoriseret
\item Availability - data og systemet er tilgængelige når de skal bruges
\end{list1}

\slide{What is data?}
\hlkimage{5cm}{Linus3-04041999.jpg}

\begin{list1}
\item Personal data you dont want to loose:
\begin{list2}
\item Wedding pictures
\item Pictures of your children
\item Sextapes
\item Personal finances
\end{list2}
\end{list1}

Source: picture of my son less than 24 hours old - precious!



\slide{Security engineering som job rolle}

\begin{alltt}\small
On any given day, you may be challenged to:
        Create new ways to solve existing production security issues
        Configure and install firewalls and intrusion detection systems
        Perform vulnerability testing, risk analyses and security assessments
        Develop automation scripts to handle and track incidents
        Investigate intrusion incidents, conduct forensic investigations and incident responses
        Collaborate with colleagues on authentication, authorization and encryption solutions
        Evaluate new technologies and processes that enhance security capabilities
        Test security solutions using industry standard analysis criteria
        Deliver technical reports and formal papers on test findings
        Respond to information security issues during each stage of a project’s lifecycle
        Supervise changes in software, hardware, facilities, telecommunications and user needs
        Define, implement and maintain corporate security policies
        Analyze and advise on new security technologies and program conformance
        Recommend modifications in legal, technical and regulatory areas that affect IT security
\end{alltt}

Source: \url{https://www.cyberdegrees.org/jobs/security-engineer/}\\
also
\url{https://en.wikipedia.org/wiki/Security_engineering}



\slide{Fokus 2020}

\begin{list2}
\item Brugerstyring
\item Asset management
\item Laptop sikkerhed
\item VPN alle steder
\item Penetration testing
\item Firewalls og segmentering
\item TLS og VPN indstillinger
\item DNS og email
\item Syslog og monitorering
\item Incident Response og reaktion
\end{list2}

\vskip 5mm
\centerline{Håber ikke I er alene om det, ellers vælg et par stykker ad gangen}

\slide{Fokus 2019: Brugerstyring}

\hlkimage{10cm}{cia-triad-uk.pdf}

\begin{list2}
\item Relevant for alle organisationer
\item Er måden vi sikrer godkendte brugere kan udføre opgaver
\item Kodeord bruges til at forhindre uautoriseret adgang
\end{list2}


\slide{Brugerstyring}

\hlkimage{8cm}{humans2.png}

\begin{list2}
\item Har I styr på brugerid?
\item Hvor er brugere oprettet?
\item Hvor hurtigt kan I fjerne "een bruger" eller "deaktivere en bruger" alle steder!
\item Er det et kludetæppe - ja, mange steder er det
\end{list2}

\hlkimage{6cm}{fyret-1.pdf}


\slide{Local administrator?}

\hlkimage{10cm}{dragon-drawing-6.jpg}

\begin{list2}
\item Findes der systemer som er helt åbne, med lokal administrator
\item Er det stadig nødvendigt
\end{list2}


\slide{Centraliseret brugerstyring}

\begin{list1}
\item Active Directory, mange danske virksomheder bruger det
\item LDAP central brugerstyring
\item ... men brug det endnu mere
\begin{list2}
\item Konfigurer applikationer til central styring
\item Fjern applikationer som ikke tillader central styring
\item Overvågning på fejlslagne logins, og godkendte logins
\end{list2}
\item Generelt minimer brugere andre steder end i den centrale database
\end{list1}

\vskip 1cm
Hvad med ILO, DRAC, temperaturovervågning - en fælles password database, med begrænset adgang, måske?


\slide{Passwords vælges ikke tilfældigt}

\hlkimage{20cm}{50-most-used-passwords.png}

Source:
\link{https://wpengine.com/unmasked/}


\slide{Your data has already have been owned by criminals}

\hlkimage{13cm}{pwned.png}

\begin{list1}
\item Your data is already being sold, and resold on the Internet
\item Stop reusing passwords, use a password safe to generate and remember
\item Check you own email addresses on \link{https://haveibeenpwned.com/}
\end{list1}

\centerline{Go ahead try the web site - hold up your hand if you are in those dumps}


\slide{Brug mere sikre passwords}

\begin{quote}
Pwned Passwords overview\\
Pwned Passwords are more than half a billion passwords which have previously been exposed in data breaches. The service is detailed in the launch blog post then further expanded on with the release of version 2. The entire data set is both downloadable and searchable online via the Pwned Passwords page.
\end{quote}

\begin{list1}
\item I kan forhindre brugere i at vælge passwords der ALLEREDE er lækket
\item I kan bruge deres API eller download\\
{\footnotesize\link{https://www.troyhunt.com/introducing-306-million-freely-downloadable-pwned-passwords/}}
\end{list1}


\slide{Formål: sund paranoia - Opbevaring af passwords}

\hlkimage{8cm}{password-window.png}

\slide{Github Public passwords?}

\hlkimage{13cm}{github-credentials.png}

 Sources:\\
{\footnotesize\link{https://twitter.com/brianaker/status/294228373377515522}\\
\link{http://www.webmonkey.com/2013/01/users-scramble-as-github-search-exposes-passwords-security-details/}\\
\link{http://www.leakedin.com/}\\
\link{http://www.offensive-security.com/community-projects/google-hacking-database/}
}

\vskip 5mm
\centerline{Use different passwords for different sites, yes - every site!}



\slide{Fokus 2019: Asset management}

\hlkimage{7cm}{old_book_lumen_design_st_01.png}

\begin{list2}
\item Specielt relevant for mellemstore til store organisationer
\item Hvilke assets har vi?
\item Hvordan sikrer vi at vi ikke mister værdierne
\end{list2}


\slide{Hvad er asset management}

\begin{quote}
CIS Control 1:\\
Inventory and Control of Hardware Assets
Actively manage (inventory, track, and correct) all hardware devices on the network so that only
authorized devices are given access, and unauthorized and unmanaged devices are found and
prevented from gaining access.
\end{quote}
Source: \link{https://www.cisecurity.org/}

\begin{list2}
\item Hardware - både indkøbte, opkoblede, udlånte, stjålne ...
\item Software - licenser, indkøb, brug, opgraderingspriser
\item Virtuelle arkiver - eksempelvis forretningskritiske data
\item ...
\end{list2}


\slide{Hardware asset management}

\hlkimage{10cm}{racktables-shot-indexpage.png}

\begin{list2}
\item Der findes mange systermer
\item Det anbefales at bruge specialiserede systemer, a la RackTables:\\
Have a list of all devices you've got,
Have a list of all racks and enclosures,
Mount the devices into the racks,
Maintain physical ports of the devices and links between them
\end{list2}

\slide{Software asset management - virtuelle arkiver}

\hlkimage{9cm}{datalaek-2019.png}

\begin{list2}
\item Software - licenser, indkøb, brug, opgraderingspriser
\item Virtuelle maskiner - er en server et asset, eller er det data?
\item IP adresser
\item Data arkiver - GDPR
\end{list2}

\slide{IP Address Management IPAM }

\hlkimage{18cm}{nipap-search.png}
\begin{list2}
\item Anbefaler Nipap \link{http://spritelink.github.io/NIPAP/}
\end{list2}

\slide{Har du styr på dependencies}

.
\hlkrightpic{10cm}{-2cm}{kyler-trautner-693525-unsplash.jpg}

\begin{list2}
\item Skal det være helt flot så få også styr på dependencies
\item Er jeres produktion afhængig af andres moduler, biblioteker osv.
\item Tænk tilbage til Heartbleed, gik flere år før de sidste opdateringer kom
\end{list2}



\slide{Fokus 2019: Laptop sikkerhed}

\hlkimage{13cm}{kelly-sikkema-212376-unsplash.jpg}

\begin{list2}
\item Relevant for alle
\item Hvordan sikrer vi at vi ikke mister værdierne, hardware og data typisk
\end{list2}


\slide{Secure Laptops}

\hlkimage{10cm}{librem-15-v3-turns99.png}

\begin{list2}
\item Laptops (og mobile enheder)
\item Hvad kendetegner en laptop?
\item Hardware naturligvis, en Macbook koster officielt mere end en brugt mellemklassebil
\item - og husk brugen af laptops
\item Er laptops sikre, og hvad betyder det?
\end{list2}



\slide{Are your data secure - data at rest}

\hlkimage{15cm}{images/data-integrity-1.pdf}

\begin{list1}
\item Stolen laptop, tablet, phone - can anybody read your data?
\item Do you trust "remote wipe"
\item How do you in fact wipe data securely off devices, and SSDs?
\item Encrypt disk and storage devices before using them in the first place!
\end{list1}


\slide{Circumvent security - single user mode boot}
\begin{list1}
\item Unix systems often allows boot into singleuser mode\\
press command-s when booting Mac OS X
\item Laptops can often be booted using PXE network or CD boot
\item Mac computers can become a Firewire disk\\
hold t when booting - firewire target mode
\item Unrestricted access to un-encrypted data
\item Moving hard drive to another computer is also easy
\end{list1}
\pause
\centerline{Physical access is often - {\bf game over}}


\slide{Encrypting hard disk}

\hlkimage{12cm}{images/apple-filevault.png}

\begin{list1}
\item Becoming available in the most popular client operating systems
\begin{list2}
\item Microsoft Windows Bitlocker
\item Apple Mac OS X - FileVault
\item FreeBSD GEOM og GBDE - encryption framework
\item Linux LUKS distributions like Ubuntu ask to encrypt home dir during installation
\item Some vendors have BIOS passwords, or disk passwords
\end{list2}
\end{list1}


\slide{Attacks on disk encryption}

\begin{list1}
\item Firewire, DMA \& Windows, Winlockpwn via FireWire\\
Hit by a Bus: Physical Access Attacks with Firewire Ruxcon 2006
\vskip 5mm
\item Removing memory from live system - data is not immediately lost, and can be read under some circumstances\\
Lest We Remember: Cold Boot Attacks on Encryption Keys\\
\link{http://citp.princeton.edu/memory/}
\item This is very CSI or Hollywoord like - but a real threat
\item VileFault decrypts encrypted Mac OS X disk image files\\ \link{https://code.google.com/p/vilefault/}

\item  FileVault Drive Encryption (FVDE) (or FileVault2) encrypted volumes\\
\link{https://code.google.com/p/libfvde/}
\end{list1}

\centerline{So perhaps use both hard drive encryption AND turn off computer after use?}

\slide{... and deleting data}

\hlkimage{8cm}{dban-screenshot.png}

\begin{list1}
\item Getting rid of data from old devices is a pain
\item Some tools will not overwrite data, leaving it vulnerable to recovery
\item Even secure erase programs might not work on SSD - due to reallocation of blocks
\item I have used Darik's Boot and Nuke ("DBAN") \link{http://www.dban.org/}
\end{list1}


\slide{2018 attack}

\hlkimage{12cm}{ssd-attack-2018.png}
\emph{self-encrypting deception: weakness in the encryption of solid state drives (SSDs)}\\
\link{https://www.ru.nl/publish/pages/909282/draft-paper.pdf}





\slide{Recommendations - Comply Everywhere, Act Anywhere}

\hlkrightpic{5cm}{-1cm}{003scawebgoshindomanicon.png}
{~}
\begin{list1}
\item {\bf Laptop storage must be encrypted}
\item Firewall must be enabled
\item Next suggestion:
\begin{list2}
\item Try sniffing data from a laptop, setup Access Point/Monitor port
\item Portscan your laptop networks - use Nmap
\item Write an email to everyone in your organisation:\\
"Hi All, we need to identify laptops without full disk encryption \\
- come see us, we have christmas cookies left, Best regards IT"
\end{list2}
\end{list1}

\slide{Fokus 2019: VPN alle steder}

\hlkimage{12cm}{ks-kyung-784757-unsplash.jpg}

\begin{list2}
\item VPN er relevant for alle der har data af værdi
\item Sikrer data der flyttes
\item Virtual Private Network dækker over klienter der kobler op, og site-2-site
\end{list2}

\slide{Your Privacy }

\hlkimage{18cm}{images/internet-browsing.pdf}


\begin{list2}
\item Your data travels far
\item Often crossing borders, virtually and literally
\end{list2}


\slide{Data found in Network data }

\begin{list1}
\item Lets take an example, DNS
\item Domain Name System DNS breadcrumbs
\begin{list2}
\item Your company domain, mailservers, vpn servers
\item Applications you use, checking for updates, sending back data
\item Web sites you visit
\end{list2}
\vskip 1cm
\item Advice show your users,ask them to participate in a experiment
\end{list1}

\emph{\bf Join this Wireless network SSID and we will show you who you are on the internet}

\vskip 2 cm
\centerline{\bf\Large Maybe use VPN more - or always!}



\slide{Fokus 2019: Penetration testing}

\hlkimage{12cm}{virksomhedens-netvaerk.pdf}

\begin{list2}
\item Relevant hvis du driver et netværk, specielt hvis det er forbundet til internet eller stort
\item Du bliver hele tiden testet - internet-tinnitus
\end{list2}

\slide{Pentesting as example}

\begin{list1}
\item Penetration testing
\item Kontrol af sikkerheden
\item Bruger aktive værktøjer
\item Brug Nmap pakken til at checke åbne porte
\end{list1}


\slide{Start Attacking from the Inside}

\hlkimage{6cm}{erik-odiin-568459-unsplash.jpg}


\begin{list2}
\item Now imagine you were in control of a company laptop
\item Do you have a large internal world wide network?\\
Having a large open network may cost you 1.9 billion DKK - ref Maersk
\item Try scanning everything, start in a small corner, expand
\item Scan all you danish segments, one by one, then the nordic, then the world
\item Yes, things may break - FINE, BREAKING is GOOD
\end{list2}

\centerline{\bf Better to break while we are ready to un-break}

\slide{How to break stuff}

Think like an attacker, and begin at the bottom.

I sit here, but where am I connected:
\begin{alltt}\footnotesize
reading from file cisco-lldp-1.cap, link-type EN10MB (Ethernet)
16:39:43.468745 LLDP, length 328
        Chassis ID TLV (1), length 7
          Subtype MAC address (4): 70:ff:1a:01:03:02 (oui Unknown)
        Port ID TLV (2), length 8
          Subtype Local (7): Eth1/47
        Port Description TLV (4), length 12: Ethernet1/47
        System Description TLV (6), length 158
          Cisco Nexus Operating System (NX-OS) Software 14.0(2c) TAC support: http://www.cisco.com/tac Copyright (c) 2002-2020, Cisco Systems, Inc. All rights reserved.
\end{alltt}

\vskip 5mm
\centerline{I love LLDP, but it does reveal software version, so which flaws available}

\slide{Hackertools are for everyone!}

\hlkimage{2cm}{hackers_JOLIE+1995.jpg}


\begin{list2}
\item Hackers work all the time to break stuff, Use hackertools:
\item Nmap, Nping \link{http://nmap.org}
\item Wireshark - \link{http://www.wireshark.org/}
\item Aircrack-ng \link{http://www.aircrack-ng.org/}
\item Metasploit Framework \link{http://www.metasploit.com/}
\item Burpsuite \link{http://portswigger.net/burp/}
\item Kali Linux \link{http://www.kali.org}
\end{list2}

\vskip 5mm
\centerline{Most popular hacker tools \link{http://sectools.org/}}


\slide{Aktiv testing What happens now?}

\begin{list1}
\item Think like a hacker
\item Recon phase -- gather information reconnaissance
\begin{list2}
\item Traceroute, Whois, DNS lookups
\item Ping sweep, port scan
\item OS detection -- TCP/IP and banner grabbing
\item Service scan -- rpcinfo, netbios, ...
\item telnet/netcat interact with services
\end{list2}
\end{list1}

\slide{Kali Linux the pentest toolbox}

\hlkimage{14cm}{kali-linux.png}

\begin{list1}
\item  Kali \link{http://www.kali.org/}
\item 100.000s of videos on youtube alone, searching for kali and \$TOOL
\item Also versions for Raspberry Pi, mobile and other small computers
\end{list1}



\slide{Nmap the world}

\hlkimage{19cm}{trinity-nmapscreen-hd-cropscale-418x250.jpg}

\slide{Really do Nmap your world}

\hlkimage{8cm}{nmap-zenmap.png}

\begin{list2}
\item Nmap is a port scanner, but does more
\item Finding your own infrastructure available from the guest network?
\item See your printers having all the protocols enabled AND a wireless?
\end{list2}

\slide{Hackerlab setup}

\hlkimage{11cm}{hacklab-1.png}

\begin{list2}
\item Create hacker labs, encourage hacker labs!
\item Software Host OS: Windows, Mac, Linux
\item Virtualisation software: VMware, Virtual box, HyperV pick your poison
\item Hackersoftware: Kali Virtual Machine \link{https://www.kali.org/}
\end{list2}

\slide{Hacking is not magic}

\hlkimage{11cm}{ninjas.png}

\begin{list2}
\item Hacking only requires some ninja training
\item We have been doing this since 1995 when SATAN was released
\item Listen, Plan, Act, Do hacking
\end{list2}

\slide{Book: Linux Basics for Hackers (LBfH)}

\hlkimage{6cm}{LinuxBasicsforHackers_cover-front.png}

\emph{Linux Basics for Hackers
Getting Started with Networking, Scripting, and Security in Kali}
by OccupyTheWeb
December 2018, 248 pp.
ISBN-13:
9781593278557

\link{https://nostarch.com/linuxbasicsforhackers}

\slide{Book: Kali Linux Revealed (KLR)}

\hlkimage{6cm}{kali-linux-revealed.jpg}

\emph{Kali Linux Revealed  Mastering the Penetration Testing Distribution}

\link{https://www.kali.org/download-kali-linux-revealed-book/}\\
explains how to install Kali Linux

\slide{Fokus 2019: Firewalls og segmentering}

\hlkimage{10cm}{virksomhedens-netvaerk.pdf}

\begin{list2}
\item Hvis du har et netværk, så bør du have en firewall
\item En firewall tillader autoriseret trafik og blokerer resten
\item Hvornår har du sidst set din løsning efter?
\item Hvor lang tid tager det at se en 5.000 linier Cisco ASA config igennem?
\end{list2}

\slide{Imagine Attacks from the Inside}

\hlkimage{6cm}{erik-odiin-568459-unsplash.jpg}

\begin{list2}
\item Now imagine you were in control of a company laptop
\item Do you have a large internal world wide network?\\
NotPetya cost Maersk about 1.9 billion DKK
%\item Try scanning everything, start in a small corner, expand
%\item Scan all you danish segments, one by one, then the nordic, then the world
%\item Yes, things may break - FINE, BREAKING is GOOD

\item entry thought to be via software update of M.E.Doc [uk] an Ukrainian tax preparation program
\item Attackers are very creative and have a large attack surface to most companies
\end{list2}

\slide{Big firewalls}

\hlkimage{15cm}{network-layers-1.png}

\centerline{Big firewalls are not a single device}



\slide{IEEE 802.1q VLANs}

\hlkimage{16cm}{vlan-8021q.pdf}

\begin{list1}
\item Med 802.1q tillades VLAN tagging på Ethernet niveau
\item Data skal omkring en firewall eller en router for at krydse fra VLAN1 til VLAN2
\item VLAN trunking giver mulighed for at dele VLANs ud på flere switches
\end{list1}


\slide{Netværk generelt}

\hlkimage{10cm}{images/librenms-switches.png}

\begin{list2}
\item Måske også på tide lige at se om der er opdateringer til switche
\item Jeg anbefaler LibreNMS \link{https://www.librenms.org/}
\end{list2}


\slide{Fokus 2019: TLS og VPN indstillinger}

\hlkimage{16cm}{bettercrypto-nginx.png}

\begin{list2}
\item De fleste har https nu, men er det konfigureret optimalt
\item Vi bruger også VPN til at forbinde sites, kontorer
\item Anbefaler at alle indstillingerne gennemgås!
\end{list2}


\slide{SSL og TLS}

\hlkimage{5cm}{crypto-class.png}

\begin{list1}
\item Oprindeligt udviklet af Netscape Communications Inc.
\item Secure Sockets Layer SSL er idag blevet adopteret af IETF og kaldes
derfor også for Transport Layer Security TLS
TLS er baseret på SSL Version 3.0
\item RFC-2246 The TLS Protocol Version 1.0 fra Januar 1999
\item RFC-3207 SMTP STARTTLS
\item Det er svært!
\item Stanford Dan Boneh udgiver en masse omkring crypto\\ \link{https://crypto.stanford.edu/~dabo/cryptobook/}
\end{list1}

\slide{Nmap efter SSL og TLS}

\hlkimage{7cm}{nmap-sslv2.png}

\begin{list1}
\item Nu vi har lært Kali og Nmap at kende
\begin{list2}
\item Find nemt alle ssl version 2 og 3\\
\verb+nmap --script ssl-enum-ciphers+
\item Brug ssllabs https://www.ssllabs.com/
\end{list2}
\end{list1}


\slide{sslscan}

\begin{alltt}\small
root@kali:~# sslscan --ssl2 web.kramse.dk
Version: 1.10.5-static
OpenSSL 1.0.2e-dev xx XXX xxxx

Testing SSL server web.kramse.dk on port 443
...
  SSL Certificate:
Signature Algorithm: sha256WithRSAEncryption
RSA Key Strength:    2048

Subject:  *.kramse.dk
Altnames: DNS:*.kramse.dk, DNS:kramse.dk
Issuer:   AlphaSSL CA - SHA256 - G2
\end{alltt}

Source:
Originally sslscan from http://www.titania.co.uk
 but use the version on Kali

SSLscan can check your own sites, while Qualys SSLLabs only can test from hostname



\slide{Weak DH paper}

\hlkimage{15cm}{weakdh-logjam.png}

Source: \link{https://weakdh.org/} and \\
\link{https://weakdh.org/imperfect-forward-secrecy-ccs15.pdf}


\slide{VPN indstillinger}

\hlkimage{9cm}{crypto-rot13.pdf}

\begin{list1}
\item PPTP, hvis du bruger det så er det godt du er kommet :-D
\item Check hvert år:
\begin{list2}
\item Certifikater/nøgler - ligesom TLS lange og rulles indimellem
\item Algoritmer DES/3DES bye bye, husk både encryption og auth algoritmer
\item DH-Group - +15 tak
\item Check både client VPN og site-2-site
\end{list2}
\end{list1}

\slide{Anbefalinger til VPN}

\begin{quote}
  Use the following guidelines when configuring Internet Key Exchange (IKE) in VPN technologies:\\
* Avoid IKE Groups 1, 2, and 5.\\
* Use IKE Group 15 or 16 and employ 3072-bit and 4096-bit DH, respectively.\\
* When possible, use IKE Group 19 or 20. They are the 256-bit and \\
384-bit ECDH groups, respectively.\\
* Use AES for encryption.
\end{quote}
Paper:\\
{\small \link{https://www.cisco.com/c/en/us/about/security-center/next-generation-cryptography.html}}

\begin{list2}
\item Certifikater/nøgler - ligesom TLS lange og rulles indimellem
\item Algoritmer DES/3DES bye bye, husk både encryption og auth algoritmer
\item DH-Group - +15 tak
\item Check både client VPN og site-2-site
\end{list2}

\slide{Fokus 2019: DNS og email}

\hlkrightpic{10cm}{-2cm}{brian-patrick-tagalog-680954-unsplash.jpg}
{~}

\begin{list2}
\item Vi er afhængige af email, modtagelse og afsendelse
\item Når vi modtager skal det helst gå hurtigt
\item Når vi sender skal vi ikke ende i spam mappen
\item Phishing, hvem kan sende \emph{fra vores domæne}
\end{list2}


\slide{Various key attack types, clients and employees}

\begin{list2}
\item Phishing - sending fake emails, to collect credentials
\item Spear phishing - targetted attacks
\item Person in the middle - sniffing and changing data in transit
\item Drive-by attacks - web pages infected with malware, often ad servers
\item Malware transferred via USB or email
\item Credential Stuffing, Password related, like re-use of password, see slide about being pwned
\end{list2}

\vskip 1cm
\centerline{\Large\bf If we all wait a bit, and not click links immediately}

\vskip 1cm
Hackers try to create "urgency", click this or loose money

\slide{DNS er mere end navneopslag}

\begin{list1}
  \item består af resource records med en type:
    \begin{list2}
\item adresser A-records
\item IPv6 adresser AAAA-records
\item autoritative navneservere NS-records
\item post, mail-exchanger MX-records
\item flere andre: md ,  mf ,  cname ,  soa ,
                  mb , mg ,  mr ,  null ,  wks ,  ptr ,
                  hinfo ,  minfo ,  mx ....
\end{list2}
\end{list1}
\begin{alltt}
        IN      MX      10      mail.zencurity.dk.
        IN      MX      20      mail2.zencurity.dk.
\end{alltt}

\slide{SMTP Simple Mail Transfer Protocol}

\begin{alltt}\tiny
hlk@bigfoot:hlk$ telnet mail.kramse.dk 25
Connected to sunny.
220 sunny.kramse.dk ESMTP Postfix
HELO bigfoot
250 sunny.kramse.dk
MAIL FROM: Henrik
250 Ok
RCPT TO: hlk@kramse.dk
250 Ok
DATA
354 End data with <CR><LF>.<CR><LF>
hejsa
.
250 Ok: queued as 749193BD2
QUIT
221 Bye
\end{alltt}

\begin{list2}
\item RFC-821 SMTP Simple Mail Transfer Protocol fra 1982
\item \link{http://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol}
\end{list2}

\slide{DNS attacks, Your registrar}

\hlkimage{10cm}{krebs-lenovo-google-dns-hack.png}
\begin{list1}
%\item DNS is the Domain Name System, \link{https://en.wikipedia.org/wiki/Dns}
\item DNS insecurity has huge impact on your security!
\item Most are denial of service, by may create Mitm or confidentiality concerns
\item Select DNS providers with care
\end{list1}


Sources:\\
{\tiny
\link{https://krebsonsecurity.com/2015/02/webnic-registrar-blamed-for-hijack-of-lenovo-google-domains/}\\
\link{http://www.version2.dk/artikel/google-og-lenovo-defaced-som-foelge-af-overset-sikkerhedsproblemstilling-91295}}


\slide{DNSSEC get started now}

\hlkimage{12cm}{cz-nic-dnssec-tlsa-validator.png}

\begin{quote}
"TLSA records store hashes of remote server TLS/SSL certificates. The authenticity of a TLS/SSL certificate for a domain name is verified by DANE protocol (RFC 6698). DNSSEC and TLSA validation results are displayer by using several icons."
\end{quote}


\slide{DNSSEC and DANE}

\begin{quote}
"Objective:

Specify mechanisms and techniques that allow Internet applications to
establish cryptographically secured communications by using information
distributed through DNSSEC for discovering and authenticating public
keys which are associated with a service located at a domain name."
\end{quote}

\begin{list1}
\item DNS-based Authentication of Named Entities (dane)
\end{list1}

\slide{Email security 2019 - Goals}

\begin{list2}
\item SPF Sender Policy Framework\\ {\footnotesize\link{https://en.wikipedia.org/wiki/Sender_Policy_Framework}}
\item DKIM DomainKeys Identified Mail\\
{\footnotesize\link{https://en.wikipedia.org/wiki/DomainKeys_Identified_Mail}}
\item DMARC Domain-based Message Authentication, Reporting and Conformance\\
{\footnotesize\link{https://en.wikipedia.org/wiki/DMARC}}
\item DANE DNS-based Authentication of Named Entities\\ {\footnotesize\link{https://en.wikipedia.org/wiki/DNS-based_Authentication_of_Named_Entities}}
\item Brug allesammen, check efter ændringer!
\end{list2}

\centerline{Jeg er glad for at teste med \link{https://dmarcian.com/}}

\slide{Fokus 2019: Syslog og monitorering}

\hlkimage{7cm}{lup.png}

\begin{list2}
\item Vi har allesammen security incidents
\item Vi skal kunne efterforske, derfor er et niveau af syslog vigtigt
\item Også i dagligdagen til at sikre at systemerne kører optimalt
\end{list2}


\slide{Network Security Through Data Analysis}

\hlkimage{6cm}{network-security-through-data-analysis.png}

\begin{list2}
\item Low page count, but high value! Recommended.
\item \emph{Network Security through Data Analysis}, 2nd edition
By Michael S Collins Publisher: O'Reilly Media
06-10-2017, 428 Pages
\end{list2}


\slide{Graphs and Dashboards!}

\hlkimage{14cm}{Logstash1.png}

\begin{list2}
\item Screenshot from Peter Manev, OISF
\item Shown are Suricata IDS alerts processed by Logstash and Kibana
\end{list2}


\slide{Network tools - examples}

\hlkimage{12cm}{kibana-solido.png}

\begin{list2}
\item Net: Zeek \link{http://www.bro-ids.org} Suricata \link{http://suricata-ids.org}
\item DNS: DSC and PacketQ \link{https://github.com/dotse/packetq/wiki}
\item Syslog: Elasticsearch, Logstash, and Kibana, called ELK stack or Elastic stack
\end{list2}


\slide{Storing query logs, old school or needed?}

\hlkimage{6cm}{bro-sample-ssl-scripts.png}

\begin{list2}
\item DNS query logs, keep it for at least a week?\\
- with DSC and PacketQ \link{https://github.com/DNS-OARC/PacketQ}
\item SSL/TLS log with Zeek/Suricata\\
{\footnotesize\link{https://www.zeek.org/sphinx-git/script-reference/scripts.html}}
\item Log with Elasticsearch?\\
{\footnotesize\link{https://www.elastic.co/guide/en/elasticsearch/guide/current/index.html}}
%\item Even netflow session logging, full 1:1 - NFSen, Suricata Flow mode?
%\item Moloch \link{https://github.com/aol/moloch}
\end{list2}

\centerline{Uetisk? eller smart hvis man vil spore hvor malware kom ind}

\slide{Network visibility: Netflow with NFSen}

\hlkimage{15cm}{nfsen-udp-flood.png}

\centerline{An extra 100k packets per second from this netflow source (source is a router)}


\slide{How to get started}

\begin{list1}
\item How to get started searching for security events?
\item Collect basic data from your devices and networks
\begin{list2}
\item Netflow data from routers
\item Session data from firewalls
\item Logging from applications: email, web, proxy systems
\end{list2}
\item {\bf Centralize!}
\item Process data
\begin{list2}
\item Top 10: interesting due to high frequency, occurs often, brute-force attacks
\item {\it ignore}
\item Bottom 10: least-frequent messages are interesting
\end{list2}
\end{list1}

\slide{Case: Maltrail}

\hlkimage{15cm}{maltrail.png}

\link{https://github.com/stamparm/maltrail}



% Suricata, Logstash, Elasticsearch, D3JShttp://d3js.org/
\slide{Suricata with Dashboards}

\hlkimage{12cm}{kibana-suricata.png}

Picture from Twitter\\
\link{https://twitter.com/nullthreat/status/445969209840128000}\\




\slide{Next steps}

In our network we are always improving things:
\begin{list1}
\item Suricata IDS \link{http://www.openinfosecfoundation.org/}
\item More graphs, with {\bf automatic identification} of IPs under attack
\item Identification of {\bf short sessions without data} - spoofed addresses
\item Alerting from {\bf existing} devices
\item Dashboards with key measurements
\end{list1}

\vskip 2cm
\centerline{\bf\Large Conclusion: Combine tools!}


\slide{Logstash pipeline }

\begin{verbatim}
input { stdin { } }
output {
  elasticsearch { host => localhost }
  stdout { codec => rubydebug }
}
\end{verbatim}



\begin{list2}
\item Logstash receives via {\bf input}
\item Processes with {\bf filters} - grok
\item Forward events with {\bf output}
\end{list2}

%Source:
%Config snippet from recommended link\\
%{\small\link{http://logstash.net/docs/1.4.1/tutorials/getting-started-with-logstash}}

\slide{Logstash as SNMPtrap and syslog server}

{\footnotesize
\begin{verbatim}
input {
  snmptrap {
    host => "0.0.0.0"
    type => "snmptrap"
    port => 1062
    community => "xxxxx"
  }
  tcp {
    port => 5000
    type => syslog
  }
  udp {
    port => 5000
    type => syslog
  }
}
\end{verbatim}
}

\begin{list2}
\item We run logstash on port 5000 - but use IPtables port forwarding
\end{list2}

Maybe you have a device sending SNMP traps right now ...

\slide{Fokus 2019: Incident Response og reaktion}

\hlkimage{10cm}{margarida-csilva-121801-unsplash.jpg}

\begin{list2}
\item Fortsat fra logningen ... hvad så nu!
\item Hvis du har en sikkerhedshændelse skal den håndteres
\item jo hurtigere og mere effektivt det håndteres jo bedre
\end{list2}

Lifeguard training photo by Margarida CSilva on Unsplash

\slide{Overlapping Security Incidents}

\hlkrightpic{12cm}{1cm}{datalaek-2019.png}

New data breaches nearly every week, these from danish news site \link{version2.dk}

Problem, we need to receive data from others

Data from others may contain malware

Have a job posting, yes\\
- then HR will be expecting CVs sent as .doc files

\slide{}

or the other way

{\Large\bf Attackers used a LinkedIn job ad\\
and Skype call to breach bank’s defences}
\hlkimage{12cm}{redbanc-skype-malware.png}

{\footnotesize
\link{https://nakedsecurity.sophos.com/2019/01/21/attackers-used-a-linkedin-job-ad-and-skype-call-to-breach-banks-defences/}}

\slide{Øv krisesituationer}

\hlkimage{12cm}{sheldon-nunes-1226991-unsplash.jpg}
\begin{list2}
\item Lav rollespil
\item Lav tabletop exercises
\end{list2}

\slide{Spørgsmål og mere debat}

\hlkimage{7cm}{idog.jpg}

\begin{center}
\hlkbig

\myname

\end{center}




\end{document}
