\documentclass[a4paper,11pt,notitlepage]{oevelser}
% Henrik Lund Kramsh�j, February 2001
% hlk@security6.net,
% course for basic IPv6
% My standard packages
\input{sec6oevelser.tex}

\begin{document}
\selectlanguage{danish}

\newcommand{\emne}[1]{TCP/IP grundkursus}
\newcommand{\kursus}[1]{\emne{} workshop}
\newcommand{\kursusnavn}[1]{\emne\\ �velsesh�fte}

\mytitle{UNIX Audit og Administration}{�velsesh�fte}

\vskip 1 cm

\begin{center}
%\colorbox{white}{\includegraphics[width=10cm]{images/kut.jpg}}
%\colorbox{white}{\includegraphics[width=15cm]{images/network-example.pdf}}
\colorbox{white}{\includegraphics[width=10cm]{images/server-client.pdf}}


\vskip 1 cm

%\colorbox{white}{\includegraphics[width=5cm]{sleuthkit.png}}
%\colorbox{white}{\includegraphics[width=5cm]{images/security6-logo-2.png}}

\colorbox{white}{\includegraphics[width=8cm]{images/logo_security6net.jpg}}


%\begin{alltt}
%\tiny
%\centerline{$Id: unix-audit-security-oevelser.tex,v 1.4 2007/07/31 10:10:19 hlk Exp $}
%\end{alltt}
\end{center}

\thispagestyle{empty}
\eject

\pagenumbering{roman}
\setlength{\parskip}{0pt}

\setcounter{tocdepth}{0}

\normal

{\color{titlecolor}\tableofcontents}
%\listoffigures - not used
%\listoftables - not used

\normal
\pagestyle{fancyplain}
\chapter*{\color{titlecolor}Forord}
\markboth{Forord}{}
Dette kursusmateriale er beregnet til brug p� kurset
\emph{\kursus}. Materialet er lavet af Henrik Kramselund  , \link{http://www.security6.net}

Materialet skal opfattes som beskrivelse af netv�rkssetup og
applikationer til kurser og workshops med behov for praktiske
�velser.

Til workshoppen h�rer desuden en pr�sentation som udleveres og der
henvises til et antal dokumenter som kan hj�lpe under �velserne.

\vskip 1cm
God forn�jelse
%\eject

\section*{\color{titlecolor}Oversigt}
\markright{Oversigt}
\setlength{\parskip}{10pt}

Materialet er inddelt i et antal omr�der som er beregnet til at give
valgfrihed i ops�tningen af milj�et.

Form�let med kurserne at ofte at give kursusdeltagerne et indblik i
hvordan emnet i praksis ser ud og opf�rer sig. De foresl�ede
konfigurationer ligger derfor t�t op ad virkelige konfigurationer, men
kan samtidig passes ind i et eksisterende kursusnetv�rk.

% beskrivelse af �velses materialet

%Der er f�lgende �velser som forventes at kunne udf�res p� det
%beskrevne netv�rk:
%\begin{itemize}
%\item IP forbindelser og sniffere
%\item SSH login - Putty og UNIX SSHD
%\item
%\end{itemize}

\section*{\color{titlecolor}Foruds�tninger}

Dette materiale foruds�tter at deltageren har kendskab til
TCP/IP p� brugerniveau. Det betyder at begreber som
\link{www.security6.net},
\href{mailto:hlk@security6.net}{hlk@security6.net}, IP-adresse og DHCP
ikke b�r v�re helt ukendte.

% ordliste ikke lavet til forensics!
%Dog er der i appendix \ref{app:ordliste} lavet en ordliste der kan
%hj�lpe med til at huske de vigtigste begreber som benyttes i dette
%materiale og indenfor \emne{} generelt.

\section*{\color{titlecolor}V�rkt�jer}
%\markright{V�rkt�jer}

Materialet er beregnet p� at kunne udf�res i et almindeligt
kursuslokale med netv�rksopkoblede pc'er.

De praktiske �velser benytter i vid udstr�kning Open Source og
kan derfor afvikles p� blandt andet f�lgende platforme:
\begin{itemize}
\item UNIX - herunder Linux, OpenBSD, NetBSD, FreeBSD og Mac OS X
\item Microsoft Windows 2000 og XP - prim�rt som
  klientoperativsystem
\item Kravene til kursisternes arbejdspladser er generelt en browser
  og SSH adgang
\item P� visse kurser udleveres en Linux boot CD som kan benyttes til
  at skifte kursusisternes arbejdsplads til at k�re Linux
\end{itemize}

Udover de programmer der gennemg�s er der f�lgende programmer som kan
v�re til stor nytte:
\begin{itemize}
%\item \link{http://www.ctan.org} - \LaTeX
\item \link{http://www.openbsd.org} - OpenBSD - en moderne UNIX med
  fokus p� sikkerhed
\item \link{http://www.openssh.com} - OpenSSH - Secure Shell
  v�rkt�jer b�de server og klientprogrammer. Giver sikkerhed mod aflytning
\end{itemize}

% =================== body of the document ===============
% Arabic page numbers
\pagenumbering{arabic}
\rhead{\fancyplain{}{\bfseries \chaptername\ \thechapter}}

% Main chapters
%---------------------------------------------------------------------
% gennemgang af �velserne
% check questions
% eventuelle �bne sp�rgsm�l
% henvisning til �velse, hvis der er en



\chapter*{\color{titlecolor}Introduktion til netv�rk}
%\markboth{Introduktion til netv�rk}{}
\label{chap:intro}

\section*{\color{titlecolor}TCP/IP - Internet protokollerne}
Det er vigtigt at have viden om IP for at kunne implementere sikre
infrastrukturer da man ellers vil have sv�rt ved at v�lge mellem de
mange muligheder for implementation.

\section*{\color{titlecolor}OSI reference model}
En af de mest benyttede modeller til beskrivelse af netv�rk er OSI
reference modellen som gennemg�s i alle datakommunikationsb�ger.

Denne model beskriver hvorledes man kan opdele funktionerne i netv�rk
i lag som s� kan implementeres uafh�ngigt og derfor kan udskiftes
nemmere - eksempelvis n�r der kommer nye transmissionsteknologier p�
de lavere niveauer.

P� billedet ses en oversigt over OSI referencemodellen, ogs� kaldet
7-lags modellen. OSI modellen sammenlignes med internetmodellen, som
ligeledes er lagdelt.

Fordelen ved at opdele i flere lag er at man kan l�se problemerne
uafh�ngigt og f�r frihed til at udskifte dele. Eksempelvis er de
nederste fysiske lag med tiden blevet hurtigere ved skift fra 10Mbit
Ethernet baseret p� coax-kabler, henover 100Mbit Ethernet p�
twisted-pair kabler til idag hvor Gigabit er udbredt.


\begin{figure}[H]
\label{fig:osi}
\begin{center}
\colorbox{white}{\includegraphics[width=8cm,angle=90]{images/compare-osi-ip.pdf}}
\end{center}
\caption{OSI og Internetmodellerne}
\end{figure}


\section*{\color{titlecolor}Standarder og RFC'er}
De dokumenter som beskriver internet-standarderne udgives i en r�kke
Request for Comments (RFC'er) som kan hentes via
\link{ftp://ftp.ietf.org/rfc}. N�r en standard eller et dokument i
denne serie opdateres sker det ved genudgivelse under et nyt nr - og
derved bevares de gamle versioner af alle dokumenterne. For at lette
navigeringen i disse dokumenter udgives et index-dokument som blandt
andet beskriver om et dokument er erstattet med en ny version. I
serien er ogs� oversigter over opdelinger indenfor RFC'erne:
eksempelvis standarder (STD), For Your Information (FYI) og Best
Current Practice (BCP).

Et eksempel fra index filen er IP specifikationen (version 4):\\
0791 Internet Protocol. J. Postel. Sep-01-1981. (Format: TXT=97779
bytes) (Obsoletes RFC0760) (Updated by RFC1349) (Also STD0005)
(Status: STANDARD)

Det betyder at \cite{RFC0791} alts� er en standard og den erstatter
\cite{RFC0760}.

Hvis man s� kigger p� den tilsvarende information for et
\emph{for�ldet} dokument ser det s�ledes ud:\\
760 DoD standard Internet Protocol. J. Postel. Jan-01-1980. (Format:
TXT=81507 bytes) (Obsoletes IEN 123) (Obsoleted by RFC0791) (Updated
by RFC0777) (Status: UNKNOWN)


\chapter*{\color{titlecolor}Hardware og netv�rk til �velserne}
%\markboth{Hardware og netv�rk til �velserne}{}

I dette afsnit beskrives de krav der stilles til milj�et hvor de
beskrevne �velser kan udf�res.

Foruds�tningerne for �velserne er et lokale med et antal PC'er
med Microsoft Windows klienter og netv�rksadgang.

En del af �velserne udf�res med UNIX, specifikt med OpenBSD, dette
valg er udfra en betragtning om at det er meget stabilt og
underst�tter de funktioner godt som beskrives i kurset.

OpenBSD er et moderne operativsystem som er frit tilg�ngeligt og fordi
det er Open Source tillader det at man kan unders�ge og tilpasse
systemet. Man kan endda benytte BSD systemerne kommercielt - hvis man
�nsker det.

Hvis der er mulighed for det kan man installere en anden UNIX variant,
ellers skal der som minimum v�re adgang til en
maskine som flere brugere deler:
\begin{itemize}
\item Et flerbruger UNIX system som eksempelvis kan v�re OpenBSD
\item et udvalg af editorer - s� folk f�ler sig hjemme, EMACS, VI,
  JOVE, Nedit ... I de grafiske brugergr�nseflader findes flere
  lettilg�ngelige  editorer, der som Nedit fungerer med en File ->
  Save menu.
\item OpenSSH - mulighed for b�de login og filoverf�rsel p� sikker vis.
\item webserver med de filer der skal bruges
\item hubs, switches, netkort - alt efter hvor komplekst et setup der
  vil arbejdes med
\end{itemize}

Et antal windows programmer stilles til r�dighed via webserveren:
\begin{itemize}
\item putty - SSH adgang fra Windows
\item winscp - nem adgang til filoverf�rsel via SSH indeholder tillige editor
\item wireshark - open source pakkesniffer
\end{itemize}


Form�let med kurset er blandt andet at forst� hvad der sker i netv�rk
og derfor introduceres emnerne ved hj�lp af konfigurationsfiler og
lavniveau beskrivelse af emnet.

Konfigurationsfilerne er ofte mere kompakte og tydelige end
tilsvarende screen-dumps fra GUI programmer.

Tilsvarende implementerer GUI programmerne ikke altid alle dele af de
underliggende lag - og er derfor ikke komplette. Eksempelvis
indeholder firewall funktionen p� Mac OS X ingen information om TCP og
UDP eller forskellen p� disse.

Alle filer er tilg�ngelige b�de p� den lokale server i kursuslokalet
og via Internet. P� kurset gives anvisninger til adgangen.


Alle filer er tilg�ngelige b�de p� den lokale server i kursuslokalet
og via Internet. P� kurset gives anvisninger til adgangen.





\chapter*{\color{titlecolor}Indholdet i �velserne}
\markboth{Indholdet i �velserne}{}

De fleste af �velserne har f�lgende indhold:
\begin{itemize}
\item {\bfseries Opgave:} Hvad g�r �velsen ud p�
\item {\bfseries Form�l:} Hvad forventes det at man l�rer ved at l�se opgaven
\item {\bfseries Forslag til fremgangsm�de:} er en hj�lp til at komme igang
\item {\bfseries Hj�lp:} et eller flere tips eller beskrivelser af hvordan
  man kan l�se opgaven
\item {\bfseries Forslag til l�sning:} en mulig l�sning til opgaven
\item {\bfseries Diskussion:} er opl�g til diskussion efter l�sning af
  opgaven. Der er mulighed for at sammenligne og diskutere de valgte
  l�sninger.
\end{itemize}


\chapter{Putty installation - Secure Shell login}
\label{ex:putty-install}
\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Installer Putty lokalt p� jeres arbejdsstation


{\bfseries �velse:}\\
Installer Putty lokalt p� Windows maskinen

{\bfseries Forslag til fremgangsm�de:}\\
Hent og installer programmet, hent fra webserveren eller\\
\link{http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html}


{\bfseries Hj�lp:}\\
Putty er en terminal emulator og erstatter telnet programmet i
Windows. Det er ofte den foretrukne brugergr�nseflade for UNIX brugere
og hackere. Husk at putty skal have at vide at det er SSH protokollen og ikke
Telnet

Hvis der skal �ndres p� profiler kan Putty godt drille lidt, husk
altid at trykke \verb+Save+ i profilvinduet - s� indstillingerne du har
valgt gemmes til n�ste gang

{\bfseries Forslag til l�sning:}\\
Hvis man kender SSH i forvejen anbefales det at man ser p�
brug af public key autentifikation herunder n�glegenerering og
installation.

{\bfseries Diskussion:}\\
SSH protokollen tillader b�de login og filoverf�rsel - secure copy

Man B�R bruge SSH protokol version 2!

{\bf NB: benyt gerne chancen til at skrive IP-adresser ind i hosts
filen lokalt p� din maskine}.

Eksempel:
\begin{alltt}
10.0.45.36    fiona
\end{alltt}

Det g�r det nemmere senere at skrive \verb+ping fiona+ for at se om
der er forbindelse til serveren.


\chapter{WinSCP installation - Secure Copy}
\label{ex:winscp-install}

{\bfseries Opgave:}\\
Installer WinSCP lokalt p� Windows maskinen

{\bfseries Forslag til fremgangsm�de:}\\
Hent og installer programmet, hent winscp fra webserveren eller fra\\
\link{http://winscp.sourceforge.net}

Installer programmet som beskrevet

{\bfseries Hj�lp:}\\
WinSCP kan v�re en stor hj�lp n�r I skal arbejde med filer p� UNIX
systemet - I kan ofte slippe for UNIX editorerne VI og EMACS

{\bfseries Diskussion:}\\
Kan WinSCP bruges generelt til opdatering af websites? hvad kr�ver
det? kan brugerne finde ud af det?

WinSCP indeholder ogs� en editor, s� vi slipper for Unix VI editor ;-)

\chapter{Login p� UNIX systemerne}
\label{ex:unix-login}

{\bfseries Opgave:}\\
Brug jeres arbejdsplads til at logge ind p� serverne

Det kr�ves at der er installeret SSH program, eksempelvis Putty fra
�velse \ref{ex:putty-install}.

{\bfseries Forslag til fremgangsm�de:}\\
Brug SSH til at logge ind p� Fiona eller en anden host i netv�rket

{\bfseries Hj�lp:}\\
Der skal bruges enten Putty p� Windows eller ssh programmet p� UNIX/boot CD

Med UNIX/boot CD og OpenSSH kan logges ind s�ledes:\\
\verb+ssh brugernavn@server -p port+ dvs p� fiona:\\
\verb+ssh kursus1@fiona -p 22+

NB: fiona er ikke med i DNS, s� brug IP-adressen!

%I kan ogs� logge ind p� Fiona som er en OpenBSD server
P� kursusservere er brugernavne: kursus1, kursus2, kursus3, op til
kursus10 - allesammen med kodeord \emph{kursus}.


{\bfseries Forslag til l�sning:}\\
Start Putty/Boot p� CD'en

{\bfseries Diskussion:}\\
Kan boot CD'en bruges til andre form�l?

Hvad indeholder CD'en?

{\bfseries Hostoplysninger:}\\

\begin{itemize}
\item I bedes registrere IP-adresserne for maskinerne
\item Filer til installation - installationsprogrammer:\\
http:// \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm /public/windows/
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm - Din egen
  arbejdsstation - Windows
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm - Fiona
  OpenBSD scanserver, nmap mv.
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm -
%\item Fiona maskinen benyttes med SSH til {\bf port 22781}!
\item Til mange opgaver er det n�dvendigt med superbruger privilegier
  - root
\item Skift til root med kommandoen: \verb+sudo -s+ - hvorefter jeres
  prompt �ndres til en have l�ge \verb+#+
\end{itemize}



\chapter{F�ling med UNIX}
\label{ex:unix-cal}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Brug manualsiderne til at besvare f�lgende sp�rgsm�l:

\begin{list2}
\item Hvad er \verb+cal+? Hvad skete der i september 1752?
\item Hvad er \verb+date+?
\item Hvad g�r \verb+clear+?
\item Hvad g�r \verb+echo+?
\end{list2}

{\bfseries Forslag til fremgangsm�de:}\\
Log ind p� systemet og udf�r opgaven fra kommandolinien.

Du kan enten skrive \verb+man cal+, \verb+man date+, \verb+man clear+,
\verb+man echo+ eller m�ske blot pr�ve at skrive kommandoerne

\begin{alltt}
$ date
...
$ cal
...
$ cal 2007
...
$ cal 1752
... osv. - output er skjult med vilje i ovenst�ende :-)
\end{alltt}

{\bfseries Hj�lp:}\\
I denne opgave er det ligegyldigt hvilken server der v�lges.
Manualsystemet bruger ofte programmet \verb+less+ til at vise manualsiderne
- dette program bruger / til at s�ge med. Tryk / og skriv et s�geord
og tryk enter.

Du kan s�ge bagl�ns med sp�rgsm�lstegnet.

{\bfseries Forslag til l�sning:}\\
Skriv \verb+man cal+ og s�g efter 1752 med /

{\bfseries Diskussion:}\\
S�gning med / og ? er ofte benyttet i UNIX programmer, eksempelvis
manualsystemet.

\chapter{UNIX - adgang til root}
\label{ex:sudo}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Hvad er forskellen mellem switch user \verb+su -+ og superuser do
\verb+sudo -+ ?

{\bfseries Forslag til fremgangsm�de:}\\
Brug manualsiderne til at besvare f�lgende sp�rgsm�l:
\begin{list2}
\item Hvad er forskellen p� \verb+su -+ og \verb+sudo -s+?
\item Kan su konfigures til ikke at kr�ve kodeord? kan sudo?
\item Hvilket kodeord skal man bruge til de to kommandoer?
\end{list2}

{\bfseries Hj�lp:}\\
Switch user er den gamle og kendte kommando til at skifte til en anden
bruger, hvis man kender p�g�ldende brugers kodeord.

Superuser do er en mere moderne m�de at skifte bruger, eller udf�re
administrationskommandoer p� UNIX. SUDO tillader at man bruger sit
eget kodeord, kodeord for brugeren man vil skifte til eller man kan
konfigurere den til ikke at kr�ve kodeord.

Su giver altid fuld adgang og man skal give root kodeord til alle.

Sudo giver fintmasket adgang til at udf�re enkelte
kommandoer. Eksempelvis vil en webadministrator kunne f� lov til at
genstarte Apache, men ellers ikke andet som root.

{\bf Diskussion:}\\
Sudo benyttes n�sten alle steder og betragtes som de facto
standarden. Nogle steder og p� egne servere/workstations benyttes den
ofte uden password - er det fornuftigt?



Vi skal bruge root adgang til at l�se konfigurationsfiler til services
og genstarte services. Pas p� n�r I k�rer som root, log evt. ind som kursusbruger altid og skift kun til root med \verb+sudo kommando+ - s� g�r det ikke helt galt :-)

Eksempel kommando med sudo:
\begin{alltt}
\small
hlk@bigfoot:hlk$ sudo apachectl configtest
Syntax OK
hlk@bigfoot:hlk$ sudo apachectl restart
hlk@bigfoot:hlk$
\end{alltt}

(Bem�rk ogs� at Unix ikke fort�ller ret meget n�r ting g�r godt)


\chapter{UNIX boot CD}
\label{ex:unix-boot-cd}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Boot en PC med en UNIX boot CD

{\bfseries Forslag til fremgangsm�de:}\\
Brug den udleverede CD i en PC, eller vi g�r det f�lles

{\bfseries Hj�lp:}\\
Der findes et stort antal boot CD'er baseret p� Linux til forskellige
form�l. Nogle af de mest kendte er:
\begin{itemize}
\item Knoppix som er beregnet til almindeligt arbejde, surfing p� net,
  Open Office skrivearbejde, E-mail med videre
\item Auditor Security Collection, nu BackTrack - en st�rre
  samling af sikkerhedsb�rkt�jer til penetrationstest
\item Damn Vulnerable Linux, en usikker Linux distribution, hvor man
  kan l�re om sikkerhedsproblemer i software
\end{itemize}

{\bf Diskussion:}\\
Til mange af CD'erne er der nogle boot koder som indimellem er
n�dvendige - typisk for at v�lge opl�sning for det grafiske
milj�. Hvis CD'en ikke virker i en bestemt maskine kan det v�re
n�dvendigt at pr�ve i en mere standard maskine.

Typisk er det fordi producenterne af tr�dl�se netkort og grafikkort
ikke vil oplyse specifikationerne og instruktionerne til at
programmere enheden.

Specielt hvis man �nsker at bruge tr�dl�se v�rkt�jer fra BackTrack2
CD'en kan det v�re en fordel at indk�be specielle netkort. Kort
baseret p� Atheros chipset plejer at virke fint.

\chapter{Basale UNIX kommandoer}
\label{ex:unix-basic-commands}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Brug manualsiderne til at besvare f�lgende sp�rgsm�l:

\begin{list2}
\item Hvad er \verb+who+ og \verb+w+ kommandoerne til?
\item Hvad viser \verb+which+ kommandoen, eksempelvis \verb+which cc+?
\item Hvad er \verb+cat+?
\item Hvad er forskellen p� \verb+more+ og \verb+less+?
\end{list2}

{\bfseries Forslag til fremgangsm�de:}\\
Log ind p� systemet og udf�r opgaven fra kommandolinien

{\bfseries Hj�lp:}\\
Programmet \verb+less+ er en efterf�lger til \verb+more+
\emph{less is more}





\chapter{Netv�rksinformation: ifconfig}
\label{ex:network-ifconfig}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Brug ifconfig til at indsamle information

{\bfseries Forslag til fremgangsm�de:}\\
Udf�r kommandoen \verb+ifconfig -a+ p� systemerne og
se information om netv�rkskort.

{\bfseries Hj�lp:}\\
Hvad er forskellen p�\\
\verb+ifconfig -a+ og \verb+ifconfig vr0+ (Linux: \verb+ifconfig eth0+)

{\bfseries Diskussion:}\\
Udover ifconfig og netstat der altid findes p� UNIX kan det v�re en
fordel at installere list open files kommandoen, \verb+lsof+. Med
denne kommando kan man se hvilke programmer der benytter hvilke filer,
herunder netv�rksforbindelser.

Bem�rk: p� Linux kaldes netv�rkskort for eth0, eth1, ... mens OpenBSD
bruger interfacenavne svarende til den driver/hardware som benyttes
nfe0, vr0, em0 osv. Mac OS X og AIX bruger en0, en1, ...

Vores systemer Fiona, Luffe og Biance benytter allesammen VIA Rhine kort.
Soekris 4801 systemer benytter sis driver, s� netkort hedder sis0, sis1 og sis2

Timon benytter Intel gigabit netkort som kaldes em0, Atheros baserede netkort til 802.11b/g kaldes typisk for ath0, ath1 osv.

AIX og Mac OS X kalder netkortene for en0, en1 - Mac OS X g�r det endda for wireless kort.

Windows kalder kommandoen ifconfig for \verb+ipconfig+ eller \verb+ipv6+ hvis det er information omkring IPv6.

Forvirret? :-)

Brug altid f�rst \verb+ifconfig -a+ evt. \verb+ifconfig -a | more+



\chapter{Netv�rksinformation: netstat}
\label{ex:network-netstat}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Brug netstat til at indsamle information

{\bfseries Forslag til fremgangsm�de:}\\
Udf�r kommandoerne \verb+netstat+ p� systemerne og
se information om netv�rkskort, lyttende serverprogrammer og
igangv�rende forbindelser.

{\bfseries Hj�lp:}\\
Hvad er forskellen p�\\
\verb+netstat -an+ og \verb+netstat -a+

Netstat har mange options, men den mest benyttede er:\\
\verb+netstat -an+ evt. kombineret med grep\\
\verb+netstat -an | grep -i listen+

Netstat kan ogs� vise memoryforbrug og interfacestatistik med -m og -i
options.

Routingtabellen vises med \verb+netstat -rn+ evt. \verb+netstat -rn -f inet+
eller \verb+netstat -rn -f inet6+


{\bfseries Diskussion:}\\
Udover ifconfig og netstat der altid findes p� UNIX kan det v�re en
fordel at installere list open files kommandoen, \verb+lsof+. Med
denne kommando kan man se hvilke programmer der benytter hvilke filer,
herunder netv�rksforbindelser.

\chapter{Netv�rksinformation: lsof}
\label{ex:network-lsof}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Brug lsof til at indsamle information

{\bfseries Forslag til fremgangsm�de:}\\
Udf�r kommandoen \verb+lsof+ p� systemerne og
se information om lyttende serverprogrammer og
igangv�rende forbindelser.

{\bfseries Hj�lp:}\\
Hvad er forskellen p�\\
\verb+lsof+ og \verb+lsof+

LSOF har mange options, men den mest benyttede er:\\
\verb+lsof -n -P+ evt. kombineret med grep\\
\verb+lsof -n -P | egrep -i "..."+

Netstat kan vise mange ting som har med filer at g�re, og alt er jo
filer p� UNIX.

{\bfseries Diskussion:}\\
Selvom lsof ikke findes som default p� UNIX kan det godt betale sig at
benytte denne, ligesom eksempelvis fport p� Windows giver den
yderst detaljeret information om systemerne.







\chapter{Opslag i whois databaser}
\label{ex:whois}


{\bfseries Opgave:} \\
L�r at bruge whois

{\bfseries Forslag til fremgangsm�de:}\\
\begin{list2}
\item Login p� UNIX server - l�s manualen til programmet whois
eller brug webinterface p�\\ \link{http://www.ripe.net}
\end{list2}

{\bfseries Hj�lp:}\\
Whois databaserne er fordelt p� ARIN, RIPE, LACNIC og APNIC.

Kommandoen \verb+whois -r 90.184.69.97+ vil p� en OpenBSD give
svaret p� et opslag i RIPE databasen efter IP adresse 90.184.69.97

{\bfseries Diskussion:}\\
I skal l�re at sp�rge efter IP adresser og spore oprindelsen - find
eksempelvis brugeren af IP-adressen 217.157.20.129



\chapter{ping og traceroute}
\label{ex:ping}

{\bfseries Opgave:}\\
L�r at bruge ping og traceroute programmerne

{\bfseries Forslag til fremgangsm�de:} \\
Brug \verb+ping+ og \verb+traceroute+ til at teste netv�rksforbindelsen - kan
udf�res fra b�de windows og UNIX.

Husk at traceroute hedder \verb+tracert+ p� windows.

Er der forbindelse til alle servere p� oversigtstegningen?

{\bfseries Hj�lp:} \\
ICMP er Internet Control Message Protocol det bruges typisk til at
rapportere om fejl, host unreachable og lignende.

Ping programmet benytter ICMP ECHO request og forventer ICMP ECHO
reply. Traceroute programmet sender ICMP eller UDP og forventer ICMP
svar tilbage for at kunne mappe et netv�rk.

{\bf Ekstra:}
Hvad er forskellen p� (skal udf�res p� OpenBSD/UNIX)
\begin{list2}
\item {\bfseries traceroute} og {\bfseries traceroute -I}
\item NB: traceroute med -I findes kun p� UNIX - traceroute med ICMP pakker
\item Der er mange der ikke blokerer for ICMP traceroute
\end{list2}

\chapter{ICMP tool - icmpush}
\label{ex:icmpush}

{\bfseries Opgave:} \\
L�r at bruge icmpush programmet

{\bfseries Forslag til fremgangsm�de:} \\
Login p� UNIX server - l�s manualen til programmet

{\bfseries Hj�lp:} \\
ICMP er Internet Control Message Protocol det bruges typisk til at
rapportere om fejl, host unreachable og lignende.

Ping programmet benytter ICMP ECHO request og forventer ICMP ECHO
reply. Traceroute programmet sender ICMP eller UDP og forventer ICMP
svar tilbage for at kunne mappe et netv�rk.

{\bfseries Diskussion:}\\
I skal l�re at sp�rge efter mindst echo, time og netmask med icmpush


\chapter{DNS og navneopslag}
\label{ex:basic-dns-lookup}

{\bfseries Opgave:}\\
Pr�v forskellige programmer til at sp�rge en service

{\bfseries Forslag til fremgangsm�de:}\\
\begin{itemize}
\item nslookup - findes b�de p� UNIX og Windows
\item Pr�v nslookup -q=txt -class=CHAOS version.bind. 0
\item dig - syntaks @server domain query-type query-class
\item host - syntaks host [-l] [-v] [-w] [-r] [-d] [-t querytype] [-a] host [server]
\item pr�v {\bfseries host -a security6.net} \\
{\bfseries host -a www.security6.net} - hvad er forskellen
\end{itemize}

{\bfseries Hj�lp:}\\
Host programmet er med som standard p� OpenBSD - s� brug Fiona eller Luffe

P� Unix Boot CD og MS Windows platformen findes mange GUI programmer til det samme.

{\bfseries Diskussion:}\\
Hvad er en zonetransfer? det er alle de records der er defineret for
et dom�ne

Hvad er forward og reverse lookup? forward er fra hostnavn til IP adresse,
mens reverse er fra IP adresse til hostnavn




\chapter{ping6 og traceroute6}
\label{ex:ping6}

{\bfseries Opgave:}\\
L�r at bruge ping og traceroute programmerne - men med IPv6

{\bfseries Forslag til fremgangsm�de:} \\
Brug \verb+ping6+ og \verb+traceroute6+ til at teste netv�rksforbindelsen - kan
udf�res fra b�de windows og UNIX.

Husk at traceroute hedder \verb+tracert6+ p� windows.

Er der forbindelse til alle servere p� oversigtstegningen?

{\bfseries Hj�lp:} \\
ICMP er Internet Control Message Protocol det bruges typisk til at
rapportere om fejl, host unreachable og lignende. IPv6 har tilsvarende ICMPv6 med samme funktioner - men har overtaget ARP funktionen.

Ping programmet benytter ICMP ECHO request og forventer ICMP ECHO
reply. Traceroute programmet sender ICMP eller UDP og forventer ICMP
svar tilbage for at kunne mappe et netv�rk.

{\bf Ekstra:}
Hvad er forskellen p� (skal udf�res p� OpenBSD/UNIX)
\begin{list2}
\item {\bfseries traceroute} og {\bfseries traceroute -I}
\item NB: traceroute med -I findes kun p� UNIX - traceroute med ICMP pakker
\item Der er mange der ikke blokerer for ICMP traceroute
\end{list2}

Det er ikke altid at IPv4 og IPv6 routes g�r gennem de samme routere! Det er med vilje lavet simpelt i vores setup.

\chapter{DNS og navneopslag - IPv6}
\label{ex:basic-dns-lookup6}

{\bfseries Opgave:}\\
Pr�v host programmet til at sp�rge efter Quad-A (AAAA) records.

{\bfseries Forslag til fremgangsm�de:}\\
\begin{itemize}
\item host - syntaks host [-l] [-v] [-w] [-r] [-d] [-t querytype] [-a] host [server]
\item pr�v {\bfseries host -t A security6.net} \\
{\bfseries host -t AAAA security6.net} - hvad er forskellen
\end{itemize}

{\bfseries Hj�lp:}\\
Host programmet er med som standard p� OpenBSD - s� brug Fiona eller Luffe

P� Unix Boot CD og MS Windows platformen findes mange GUI programmer til det samme.

{\bfseries Diskussion:}\\
DNS har mange recordtyper og AAAA er blot endnu en. Typisk vil programmer der har IPv6 funktionalitet fors�ge at sl� b�de AAAA records og A records op - og fors�ge at forbinde til AAAA f�rst.

\chapter{Netv�rksinformation: sysctl}
\label{ex:sysctl}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Brug sysctl kommandoen til at indsamle information

{\bfseries Forslag til fremgangsm�de:}\\
Udf�r kommandoen \verb+sysctl -a | grep net+ p� systemerne og
se information om IP-stakken p� systemet.

{\bfseries Hj�lp:}\\

Sysctl giver adgang til mange informationer:\\
\verb+net.inet.ip.forwarding+\\
\verb+net.inet6.ip6.forwarding+\\

Netstat kan ogs� vise memoryforbrug og interfacestatistik med -m og -i
options.

{\bfseries Diskussion:}\\
Udover ifconfig og netstat der altid findes p� UNIX kan det v�re en
fordel at installere list open files kommandoen, \verb+lsof+. Med
denne kommando kan man se hvilke programmer der benytter hvilke filer,
herunder netv�rksforbindelser.



\chapter{Performance tool - iperf}
\label{ex:iperf}

{\bfseries Opgave:} \\
L�r at bruge iperf programmet

{\bfseries Forslag til fremgangsm�de:} \\
Login p� UNIX server - l�s manualen til programmet

{\bfseries Hj�lp:} \\
Iperf er et lille nemt program som blot skal startes som server p� en maskine og derefter kaldes som klient p� et andet. S� m�ler den som default et kort stykke tid og pr�senterer resultatet.

{\bfseries Diskussion:}\\
Til rigtige performancem�linger er det uhensigtsm�ssigt at netv�rket benyttes til anden traffik under m�lingerne, medmindre man �nsker at m�le nu og her.



\chapter{Afpr�v Apache Benchmark programmet}
\label{ex:apache-benchmark}

{\bfseries Opgave:}\\
Afpr�v ApacheBench programmet

{\bfseries Forslag til fremgangsm�de:}\\
Pr�v at k�re med 100 eller 1000 foresp�rgsler p� en fil/url

{\bfseries Hj�lp:}\\
Pr�v \verb+ab -n 100 http://kursus1.pentest.dk/+


{\bfseries Diskussion:}\\
Hvorn�r vil det v�re relevant at bruge ApacheBench?

\chapter{TCP/IP og sniffere}
\label{ex:wireshark}

\hlkimage{9cm}{images/ethereal-main-window.pdf}

{\bfseries Opgave:}\\
Pr�v en Wireshark sniffer p� din maskine!

Brug lidt tid p� at l�re den at kende.

{\bfseries Forslag til fremgangsm�de:}\\
Find Wireshark og installer denne, hent fra den lokale webserver eller \link{http://www.wireshark.org}

{\bfseries Hj�lp:}\\
Find ud af hvordan det er underst�ttet i dit favorit operativsystem
ved at bruge eksempelvis \link{http://www.google.com}

{\bfseries Forslag til l�sning:}\\
Windows - hvis du er p� Windows skal der
installeres WinPCAP - packet capture - biblioteket. Dette kan
eksempelvis hentes p� den lokale webserver. I nyere versioner af
Wireshark f�lger dette med i installationsfilen.

%adressen:
%\href{http://www.security6.net/courses/programs/WinPcap_3_0_beta.exe}
%{http://www.security6.net/courses/programs/WinPcap\_3\_0\_beta.exe}

UNIX - de fleste UNIX varianter har installationspakker til Wireshark
og TCPdump

Pr�v efter installationen at kigge p� den normale trafik p� nettet,
eller generer selv trafik med ping og traceroute (windows: tracert)
programmer
- n�r dette er gjort virker snifferen

{\bfseries Diskussion:}\\
Kender du forskel p� ICMP, TCP og UDP? Pr�v at skrive
\verb+icmpush -h+ mens du er logget ind p� kursusserveren -
senere. Hvad er det for et program?

Hvilke protokoller bruger kryptering?

Husk ogs� at sniffe en TCP session og sammens�t alle pakkerne med
TCP Follow Stream funktionaliteten.

Wireshark er en efterf�lger til Ethereal, navneskiftet skyldes et jobskifte hvor ejeren af Ethereal dom�net ikke ville give det med programm�ren.



\chapter{Logning med syslogd og syslog.conf}
\label{ex:syslogd-basic}

{\bfseries Opgave:}\\
log ind p� et OpenBSD UNIX system og se p� \verb+syslog.conf+

{\bfseries Forslag til fremgangsm�de:}\\
\begin{list2}
\item Hvor ligger den? - i hvilket katalog?
\item Hvordan kan man sende loggen videre til en anden maskine?
\item Hvilken protocol og port bruger syslog - hvis I skal tillade det
  gennem en firewall?
\end{list2}

{\bfseries Hj�lp:}\\
 Indholdet af filen kan ses p� n�ste slide

\begin{alltt}
\small
*.err;kern.debug;auth.notice;authpriv.none;mail.crit    /dev/console
*.notice;auth,authpriv,cron,ftp,kern,lpr,mail,user.none /var/log/messages
kern.debug;user.info;syslog.info                        /var/log/messages
auth.info                                               /var/log/authlog
authpriv.debug                                          /var/log/secure
...
# Uncomment to log to a central host named "loghost".
#*.notice;auth,authpriv,cron,ftp,kern,lpr,mail,user.none        @loghost
#kern.debug,user.info,syslog.info                               @loghost
#auth.info,authpriv.debug,daemon.info                           @loghost
\end{alltt}

{\bfseries Diskussion:}\\
Se ogs� \link{http://www.loganalysis.org/}





\chapter{SNMP walk}
\label{ex:snmpwalk}

{\bfseries Opgave:}\\
Log ind p� et OpenBSD UNIX system og se p� \verb+snmpwalk+

{\bfseries Forslag til fremgangsm�de:}\\
SNMP walk betyder at man g�r igennem alle SNMP oplysningerne fra et system.

{\bfseries Hj�lp:}\\
\verb+snmpwalk -v 2c -c public system+

Public er default p� meget udstyr og findes stadig mange steder i produktion.

Private er et andet kendt community name og gav tidligere lov til at �ndre indstillingerne p� enheder.

{\bfseries Diskussion:}\\



\chapter{AirPort Extreme}
\label{ex:AirPort-AP}

{\bfseries Opgave:}\\
Konfiguration af Apple AirPort Extreme

{\bfseries Forslag til fremgangsm�de:}\\
Hent AirPort konfigurationsprogrammet til Windows og
brug denne til at konfigurere Apple AirPort

{\bfseries Hj�lp:}\\
Manualen til udstyret forefindes i PDF format

{\bfseries Forslag til l�sning:}\\
S�t det tr�dl�se udstyr i et isoleret netv�rk n�r det skal konfigureres

{\bfseries Diskussion:}\\
Hvad er de to LAN stik til? - begge er jo Ethernet?

S�rg for at unders�ge alle mulighederne i konfigurationen



\chapter{Wardriving p� Windows - netstumbler}
\label{ex:wardriving-windows}

{\bfseries Opgave:}\\
Installer netstumbler p� en Windows laptop - og lav wardriving

Kr�ver I har et netkort der er underst�ttet

{\bfseries Forslag til fremgangsm�de:}\\
Med netstumbler(windows), Kismet(unix) og iStumbler kan man
scanne efter tr�dl�se netv�rk med almindeligt tr�dl�st udstyr

{\bfseries Hj�lp:}\\

{\bfseries Forslag til l�sning:}\\

{\bfseries Diskussion:}\\
Er det lovligt?

Hvorfor er der s� mange �bne netv�rk?


\chapter{Wardriving p� UNIX - Kismet}
\label{ex:wardriving-kismet}

{\bfseries Opgave:}\\
Afpr�v Kismet laptoppen - og lav wardriving

Kr�ver I har et netkort der er underst�ttet af Boot CD/Linux

{\bfseries Forslag til fremgangsm�de:}\\
I skal blot se hvorledes wardriving tager sig ud p� UNIX - kende
programmerne

{\bfseries Hj�lp:}\\

{\bfseries Forslag til l�sning:}\\
I skal v�re velkomne til at unders�ge hvordan Kismet installeres

{\bfseries Diskussion:}\\
Der findes ``stumbler'' programmer til de mest benyttede platforme,
men hvilke kort underst�ttes!

Det kan ofte v�re en god ide at unders�ge om det kort man vil k�be kan
bruges til at wardrive - idet wardriving er vigtigt internt i
virksomhederne for at finde uautoriserede (engelsk: rogue) access
points.





\chapter{BIND version}
\label{ex:bind-version}

{\bfseries Opgave:} \\
Find version p� BIND software p� UNIX

{\bfseries Forslag til fremgangsm�de:}\\
Brug en af f�lgende kommandoer til at finde version p� BIND p�
navneserveren:\\

\verb+nslookup -q=txt -class=CHAOS version.bind. 0 server+

\verb+dig @server version.bind chaos txt+


{\bfseries Hj�lp:} \\

{\bfseries Diskussion:} \\
BIND softwaren er ofte udsat for angreb

BIND og navnesystemet er kritisk for mange funktioner som web og mail

\chapter{Tilpasning af DNS server}
\label{ex:bind-config}
{\bfseries Opgave:}\\
Konfiguration af en BIND ved hj�lp af named.conf, men hvordan ser den ud.

{\bfseries Forslag til fremgangsm�de:}\\

Log ind p� Luffe, som afvikler en rekursiv DNS og Mai som afvikler en autoritativ navneserver.

Begge benytter OpenBSD hvor BIND er installeret med konfiguration og data under \verb+/var/named+.

\begin{list1}
\item Find ud af - hvad er:
\begin{list2}
\item master server
\item slave server
\item caching-only server
\end{list2}
\item \verb+/var/named+ kataloget, hint chroot'et installation
\item \verb+/var/named/etc+ - underkataloget, hint konfiguration
\item \verb+/var/named/standard+ - underkataloget, hint localhost
\end{list1}

{\bfseries Hj�lp:}\\
BIND er installeret - s� find \verb+named.conf+ og l�s den

{\bfseries Diskussion:}\\
Det er altid en god ide at en navneserver kan svare p� localhost.


\chapter{Vedligehold af DNS systemer}
\label{ex:bind-dnszone}
\hlkimage{8cm}{images/dnszone-logo.png}
{\bfseries Opgave:}\\
Pr�v et gratis adminsystem til DNS

{\bfseries Forslag til fremgangsm�de:}\\
G� ind p� \link{http://www.dnszone.org} og pr�v demo sitet, eller
se gratisdns interface som instrukt�ren kan vise.

{\bfseries Hj�lp:}\\
Det anbefales KRAFTIGT at man bruger et system til vedligehold af
DNS oplysninger

{\bfseries Diskussion:}\\
Der findes mange programmer og produkter til administration af DNS -
eksemplet ovenfor er kun et af disse.

N�r man har konfigureret DNS b�r man overveje at finde en service p�
nettet der checker konfigurationen, eksempelvis DNS advisor fra
\link{http://www.infoblox.com} eller \link{http://www.dnsreport.com}.

Husk efter konfiguration af et dom�ne at checke det med programmer som dem p�
\link{http://www.infoblox.com} eller \link{www.dnsreport.com}


\chapter{Konfiguration af DHCP server}
\label{ex:dhcpd-config}

{\bfseries Opgave:}\\
Konfiguration af en DHCPD foreg�r ved hj�lp af dhcpd.conf

{\bfseries Forslag til fremgangsm�de:}\\
Unders�g dhcpd.conf p� vores systemer.

{\bfseries Hj�lp:}\\
Log ind p� systemerne og vis netv�rkskonfigurationen med \verb+ifconfig+
og dhcpd.conf filen med \verb+cat /etc/dhcpd.conf+ - Luffe er den nemmeste at v�lge.

N�r dhcpd startes p� OpenBSD benyttes tillige \verb+/etc/dhcpd.interfaces+ til at v�lge
hvilke netkort der skal svares p� DHCP.

\begin{alltt}
#
# DHCP server options.
# See dhcpd.conf(5) and dhcpd(8) for more information.
#
#
shared-network LOCAL-NET {
        option  domain-name "kramse.dk";
        #option  domain-name-servers 192.168.1.3, 192.168.1.5;
        subnet 10.0.45.0 netmask 255.255.255.0 {
                option routers 10.0.45.2;
                range 10.0.45.32 10.0.45.200;
        }
}
\end{alltt}

{\bfseries Diskussion:}\\
Det ville v�re n�sten umuligt for almindelige brugere at benytte en laptop, hvis de manuelt skulle skifte adresse fra netv�rk til netv�rk.

Det er ofte set at folk der manuelt s�tter en adresse ender med at s�tte router adressen p� deres netkort, hvad sker der s�?




\chapter{Opbygning af Apache httpd.conf}
\label{ex:apache-httpd.conf}

{\bfseries Opgave:}\\
Se p� konfigurationsfilen til Apache som hedder \verb+httpd.conf+

{\bfseries Forslag til fremgangsm�de:}\\
- den er lang og det er ikke helt trivielt at konfigurere Apache!

l�s lidt i den og pr�v at forst� dele af opbygningen

tilpas konfigurationen af webserveren, email adresser, hostnavn mv.

{\bfseries Hj�lp:}\\
hint: brug navnet www.pentest.dk til serveren og dom�net pentest.dk
til de virtuelle hosts, og s�rg for at dette
senere laves i DNS serveren - samt \verb+/etc/hosts+ p� systemet!

{\bfseries Diskussion:}\\
Husk at gemme en kopi af den oprindelige httpd.conf fil!

Det anbefales at bruge versionsstyring til konfigurationen

\chapter{Apache virtuelle hosts}
\label{ex:apache-virtual}


{\bfseries Opgave:}\\
Se p� virtuelle hosts p� web serveren

{\bfseries Forslag til fremgangsm�de:}\\
Unders�g httpd.conf og tilh�rende virtuelle konfiguration


{\bfseries Hj�lp:}\\
Oprette evt. kataloger med HTML filerne index.html - med
forskelligt indhold

{\bfseries Diskussion:}\\
NB: husk at hostnavnet overf�res fra klienten! I skal alts� sikre jer
at der st�r et navn og IP-adresse i /etc/hosts filen p� klienten! (p�
Windows ligger den typisk under \verb+c:\winnt\system32\drivers\etc\hosts+

Hvis I bruger de forberedte virtuelle hosts, som er oprettet svarende til kursusbrugere
kursus1.pentest.dk burde det virke. Dvs brug navneserveren p� netv�rket gennem DHCP :-)

% mellemting



\chapter{Konfiguration af e-mail server}
\label{ex:email-server-config}

{\bfseries Opgave:}\\
Der skal laves e-mail server baseret p� postfix
  som accepterer post til pentest.dk dom�net

Valgfrit om man vil lave denne opgave :-)

{\bfseries Forslag til fremgangsm�de:}\\
Log ind og udpak postfix kildeteksten i jeres hjemmekatalog. Brug eksempelvis Fiona kursusserveren.

Konfigurer til at installere i jeres hjemmekatalog og skift eventuelt
portnummer - s� der ikke kommer konflikt med de andre p� holdet

NB: Hvis flere starter server der vil lytte p� port 25 giver det
problemer! I kan �ndre portnummer i Postfix master.cf - linien der
starter med "smtp" �ndres til eksempelvis "2025"


Tip: I kan teste serveren ved at fors�ge \emph{telnet localhost
  portnr} og indtaste e-mail direkte

{\bfseries Hj�lp:}\\
Test af e-mail server kan udf�res med Telnet

\begin{alltt}
[hlk]$ {\bfseries telnet localhost 2025}
Connected.
Escape character is '^]'.
220 server ESMTP Postfix
{\bfseries helo test}
250 server
{\bfseries mail from: postmaster@pentest.dk}
250 Ok
{\bfseries rcpt to: root@pentest.dk}
250 Ok
{\bfseries data}
354 End data with <CR><LF>.<CR><LF>
{\bfseries skriv en kort besked}
.
250 Ok: queued as 91AA34D18
{\bfseries quit}
\end{alltt}
%$

{\bfseries Diskussion:}\\
Det er vigtigt at en server kan komme af med beskeder om systemets
tilstand. Husk derfor altid at sikre at der k�rer en postserver -
eventuelt den medf�lgende Sendmail.

Til servere der skal modtage post og sende det videre anbefales
Postfix - den er nemmere at konfigurere end Sendmail.

Husk ogs� at oprette en fil \verb+.forward+ for brugere, s�ledes at
mail ikke strander p� servere. Denne fil skal blot indeholde en e-mail
adresse hvor posten skal sendes videre til.



\chapter{RPC info}
\label{ex:unix-rpcinfo}

{\bfseries Opgave:} \\
Find RPC services p� UNIX

{\bfseries Forslag til fremgangsm�de:} \\
Brug programmet til at checke om der findes RPC services p� vores servere

\verb+rpcinfo -p fiona+

{\bfseries Hj�lp:} \\
RPC info programmet kontakter portmapper programmet p� den p�g�ldende
server og f�r en liste over de tilg�ngelige services

{\bfseries Diskussion:}\\
B�r denne funktion v�re tilg�ngelig p� produktionsudstyr?

Hvad er ulempen ved services der ikke ligger p� faste porte?
(hint: t�nk firewalls)

\chapter{NFS info}
\label{ex:unix-nfsinfo}

{\bfseries Opgave:} \\
Find NFS shares p� UNIX

{\bfseries Forslag til fremgangsm�de:} \\
Brug kommandoen \verb+showmount -e + til at vise hvilke kataloger der
eksporteres fra en server.

{\bfseries Hj�lp:} \\
RPC info programmet kontakter portmapper programmet p� den p�g�ldende
server og f�r en liste over de tilg�ngelige services. I denne liste over services findes NFS
og med en kommando kan man se hvilke kataloger der eksporteres - og rettigheder.

{\bfseries Diskussion:}\\
B�r denne funktion v�re tilg�ngelig p� produktionsudstyr?

Hvad er ulempen ved services der er baseret p� IP-adresse som sikkerhedsmekanisme.

NFS findes i flere versioner, version 3 er mest udbredt men NFSv4 er p� vej og giver
bedre sikkerhed.




\chapter{Firewallkonfiguration}
\label{ex:unix-basic-firewall}

{\bfseries Opgave:}\\
Konfiguration af en firewall - se eksempler, f�llesopgave

{\bfseries Forslag til fremgangsm�de:}\\
\begin{list2}
\item Hvordan enabler man firewall?
\item Hvordan �bner man for noget i vores firewall?
\item Tilf�j en regel for at tillade adgang til noget mere p� vores
  systemer
%\item G� sammen i hold pr system
\end{list2}

P� OpenBSD kan man se om firewall er enablet med kommandoen \verb+pfctl+. Pr�v f�lgende kommandoer p� eksempelvis Luffe
\begin{list2}
\item \verb+sudo pfctl -s all | more+
\item \verb+sudo pfctl -s rules | more+
\item \verb+sudo pfctl -s nat | more+
\item \verb+sudo pfctl -s states | more+
\item \verb+sudo pfctl -s info | more+\\
...
\end{list2}



{\bfseries Hj�lp:}\\
Vi gennemg�r sammen �ndringen p� de forskellige firewalls vi har til
r�dighed!

%Hint: se p� \verb+/etc/sysconfig/iptables+
%og \verb+system-config-securitylevel+

%NB: Hvis I oplever problemer med Red Hat konfigurationsv�rkt�jerne og
%X kan I lave \verb+unset DISPLAY+ for at tvinge det til tekstmode udgaven.

{\bfseries Diskussion:}\\
S�rg for at Henrik viser flere firewalls!

Der er GUI p� Mac OS X, Windows, Linux og ogs� til OpenBSD PF pfw




\chapter{Find maskiner}
\label{ex:nmap-sweep}

{\bfseries Opgave:}\\
Log p� UNIX og brug nmap til at s�ge efter maskiner p� lokalnetv�rket som ping sweep eller port sweep

{\bfseries Forslag til fremgangsm�de:}\\
Lav forskellige typer scan og
inddel resultaterne efter:
\begin{list2}
\item aktive systemer
\item �bne porte/services
\end{list2}

{\bfseries Hj�lp:} \\
Pr�v med Nmap sweep:
\begin{list1}
\item \verb+nmap -sP 10.0.45.*+
\item \verb+nmap -p 80 10.0.45.*+
\item Pr�v ogs� gerne de andre netv�rk, .46 .53 osv.
\end{list1}

{\bfseries Diskussion:}\
Er det noget som foreg�r p� Internet? Ja, konstant


\chapter{nmap portscanning}
\label{ex:nmap-portscan}

{\bfseries Opgave:} \\
Brug nmap til at finde �bne porte p� netv�rket

{\bfseries Forslag til fremgangsm�de:}\\
Brug \verb+nmap -p 1-1024 server+ til at scanne de f�rste 1024 TCP
porte p� en server
Brug \verb+nmap -sU+ til at scanne efter UDP porte og \verb+-P0+
option til at undg� at sende ping f�rst

{\bfseries Hj�lp:} \\
Eksempel: \verb+nmap -P0 -sU -p1-1024 server+ UDP portscanning af port
1-1024 uden ping f�rst

{\bfseries Diskussion:}\\
TCP og UDP portscanning er meget forskelligt. TCP er
forbindelsesorienteret og har session setup i form af en three-way
handshake som g�r at en client f�rst sender TCP-SYN, server svarer med
TCP-SYN+ACK og derefter etableres forbindelsen endeligt med TCP-ACK fra
klienten. UDP er forbindelsesl�s kommunikation og der er ingen session
setup - derfor er UDP scanning mere up�lideligt.

\chapter{nmap servicescanning}
\label{ex:nmap-service}

{\bfseries Opgave:} \\
Brug nmap service detection til at finde ud af hvilke services der
gemmes sig bagved de �bne porte p� netv�rket

{\bfseries Forslag til fremgangsm�de:}\\
Brug \verb+nmap -A+ option til at sl� service detection til

{\bfseries Hj�lp:} \\
Kig p� manual siden til nmap

{\bfseries Diskussion:}\\
Hvordan finder man ud af hvilken protokol der ligger bagved en port?


\chapter{nmap OS detection}
\label{ex:nmap-os}

{\bfseries Opgave:} \\
Brug nmap OS detection til at finde operativsystemerne p� netv�rket

{\bfseries Forslag til fremgangsm�de:}\\
Find listen med aktive systemer fra tidligere (eller lav sweeps)
kig p� manualsiderne {\bfseries man nmap}
udf�r OS detection p� de fundne maskiner

{\bfseries Hj�lp:} \\
Brug \verb+nmap -O+ option til at sl� OS detection til

Nmap portscanneren kan sende specielle pakker og dermed udlede hvilket
operativsystem der gemmer sig - udfra de svar der kommer retur

{\bfseries Diskussion:}\\
Nmap OS detection er ikke altid lige pr�cis - det hj�lper hvis der
angives b�de en �ben og en lukket port - hvorfor?
og {\bfseries man xprobe}




\chapter{Chroot af BIND}
\label{ex:bind-chroot}


{\bfseries Opgave:}\\
Hvad er chroot af BIND, forst� konceptet af adskillelse

{\bfseries Forslag til fremgangsm�de:}\\
\begin{list1}
\item find mindst en beskrivelse af hvordan man chroot'er BIND
\item valgfrit om I finder beskrivelsen til:
  \begin{list2}
    \item Linux
\item OpenBSD
\item eller andre UNIX systemer
  \end{list2}
\item L�s den og pr�v at forst� den
\end{list1}

{\bfseries Hj�lp:}\\
Chroot giver en god ekstra sikkerhed med services som BIND!

{\bfseries Diskussion:}\\
B�de Solaris og FreeBSD giver med zones og jail flere muligheder for
at styre og kontrollere serverprogrammer.



\appendix
\rhead{\fancyplain{}{\bfseries\leftmark}}
%\setlength{\parskip}{5pt}
\normal

\chapter{OpenSSH template}

Her pr�senteres en konfigurationsfil til OpenSSH
serveren. Konfigurationen er fors�gt tilpasset til produktionsbrug i
enterprisemilj�er.

Filen kan findes og downloades via internetadressen:\\
\url{http://www.kramse.dk/projects/unix/opensshtemplate_en.html}



\VerbatimInput{files/sshd_config.template}



\chapter{Start-stop script til services}

Mange applikationer inkluderer egne start-stop scripts, men hvis de
ikke g�r er nedenst�ende en mulighed for at lave sit eget.

Scriptet kan eksempelvis udf�res under boot eller via alias:
\begin{alltt}
\small
alias tomcat=' sudo -u tomcat /userdata/tomcat/bin/tomcat'
\end{alltt}

\VerbatimInput{files/tomcat}

\chapter{Korn shell login-profil }

Det er vigtigt at man bruger tid p� at indstille sin shell efter egne
�nsker og behov.

Nedenfor findes en .profile der kan benyttes med Korn Shell - NB:
denne er beregnet til brug med pdksh, som er public domain Korn Shell.

%\begin{alltt}
%\small
\VerbatimInput{files/profile}
%\end{alltt}



\chapter{Hostoplysninger}

\begin{itemize}
\item I bedes registrere IP-adresserne for maskinerne
\item Filer til installation - installationsprogrammer:\\
http:// \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm
/public/windows/ - webserver med diverse tools
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm - Fiona
\item Fiona maskinen benyttes med SSH til {\bf port 22781}!
\item Kursus login brugernavne: kursus1, kursus2, ... kursus10
kodeord: \verb+kursus+ - uanset brugernavn
\item Skift til root med: \verb+sudo -s+
\end{itemize}

\section*{Vores maskiner}
\begin{itemize}
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm -
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm -
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm -
  OpenBSD
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm -
  OpenBSD scanserver
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm - Din egen
  arbejdsstation - Windows/Linux
\end{itemize}



% der er ikke lavet ordliste til forensics workshop
%\chapter{Ordliste og forklaringer}
%\label{app:ordliste}
%\input{../ipv6-reference/wordlist.dk.tex}


%\chapter{Sikkerhed}

%N�r man aktiverer \emne �bner man mange muligheder for angreb!

%Det vil ofte v�re muligt at skabe adgang til netv�rket for
%uvedkommende og det er derfor n�dvendigt med l�bende kontrol,
%overv�gning og udskiftning af hemmeligheder som kodeord.

%IPsec er et krav til alle IPv6 implementationer, s� man ved at man har
%muligheden for at kommunikere sikkert.

%Wireless teknologier og IPv6 er blot to emner der har indflydelse p�
%sikkerheden i dagens netv�rk - men ofte kan det integreres fornuftigt
%med b�de virksomheden og de netv�rk som skal forbindes til
%infrastrukturen.

%Det anbefales at l�se bogen: \title{Firewalls and {Internet} Security:
%  Repelling the Wily Hacker}, \cite{Cheswick:2003:FIS}


\bibliographystyle{alpha}
%\bibliography{../ipv6-reference/security6-net.bib,../ipv6-reference/rfc.bib,../ipv6-reference/std.bib,../ipv6-reference/fyi.bib}
\bibliography{kramse.bib,rfc.bib,std.bib,fyi.bib}
%,internet.bib}


%\printindex

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
